<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Budget Planner - Create Your Budget</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          Roboto,
          sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        color: #1e293b;
        line-height: 1.6;
        overflow-x: hidden;
      }

      .app-container {
        display: flex;
        min-height: 100vh;
      }

      /* Header */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 70px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 2rem;
        z-index: 100;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .logo-area {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .logo-icon {
        font-size: 1.75rem;
      }

      .logo-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1e293b;
      }

      .breadcrumb {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .header-nav {
        display: flex;
        gap: 1rem;
      }

      .nav-item {
        padding: 0.5rem 1rem;
        border-radius: 6px;
        font-weight: 500;
        color: #64748b;
        text-decoration: none;
        transition: all 0.2s ease;
      }

      .nav-item.active {
        background: #1e293b;
        color: white;
      }

      .nav-item:hover:not(.active) {
        background: rgba(241, 245, 249, 0.8);
        color: #1e293b;
      }

      /* Sidebar */
      .sidebar {
        width: 320px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-right: 1px solid rgba(226, 232, 240, 0.8);
        position: fixed;
        left: 0;
        top: 70px;
        bottom: 0;
        overflow-y: auto;
        z-index: 50;
        display: flex;
        flex-direction: column;
      }

      .sidebar-section {
        padding: 1.5rem;
        border-bottom: 1px solid rgba(226, 232, 240, 0.5);
      }

      .sidebar-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 1rem;
      }

      /* Step Progress */
      .step-progress {
        margin-bottom: 1.5rem;
      }

      .step-item {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        padding: 0.75rem;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .step-item.active {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .step-item.completed {
        background: rgba(16, 185, 129, 0.1);
        color: #059669;
      }

      .step-number {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-weight: 700;
        font-size: 0.875rem;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
      }

      .step-item.active .step-number {
        background: rgba(255, 255, 255, 0.9);
        color: #059669;
        border-color: rgba(255, 255, 255, 0.9);
      }

      .step-item.completed .step-number {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .step-details h4 {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .step-description {
        font-size: 0.75rem;
        opacity: 0.8;
      }

      /* Running Total */
      .running-total {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .total-title {
        font-size: 0.875rem;
        opacity: 0.9;
        margin-bottom: 0.5rem;
      }

      .total-amount {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .total-status {
        font-size: 0.75rem;
        opacity: 0.9;
      }

      /* Tips */
      .tips-section {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid rgba(226, 232, 240, 0.8);
      }

      .tips-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.75rem;
      }

      .tip {
        font-size: 0.75rem;
        color: #64748b;
        margin-bottom: 0.5rem;
        padding-left: 1rem;
        position: relative;
      }

      .tip:before {
        content: '💡';
        position: absolute;
        left: 0;
        top: 0;
      }

      /* Main Content */
      .main-content {
        margin-left: 320px;
        margin-top: 70px;
        padding: 2rem;
        min-height: calc(100vh - 70px);
        max-width: calc(100vw - 320px);
        width: calc(100vw - 320px);
      }

      /* Step Container */
      .step-container {
        max-width: 900px;
        margin: 0 auto;
      }

      .step-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .step-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 0.75rem;
      }

      .step-subtitle {
        font-size: 1.125rem;
        color: #64748b;
        max-width: 600px;
        margin: 0 auto;
      }

      /* Form Styles */
      .form-grid {
        display: grid;
        grid-template-columns: 1fr 400px;
        gap: 3rem;
        margin-bottom: 3rem;
      }

      .form-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }

      .income-source {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
      }

      .income-source.primary {
        border-color: #10b981;
        box-shadow: 0 8px 32px rgba(16, 185, 129, 0.15);
      }

      .income-source:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      .source-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .source-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.125rem;
        font-weight: 600;
        color: #1e293b;
      }

      .source-badge {
        background: #10b981;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .source-badge.secondary {
        background: #64748b;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.5rem;
        display: block;
      }

      .type-selector {
        display: flex;
        background: #f1f5f9;
        border-radius: 8px;
        padding: 0.25rem;
        margin-bottom: 1rem;
      }

      .type-option {
        flex: 1;
        padding: 0.5rem 1rem;
        background: transparent;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.875rem;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .type-option.active {
        background: white;
        color: #1e293b;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .amount-section {
        background: #f8fafc;
        padding: 1.5rem;
        border-radius: 12px;
        border: 2px solid #e2e8f0;
      }

      .amount-type-toggle {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .amount-type-btn {
        padding: 0.5rem 1rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
      }

      .amount-type-btn.active {
        background: #1e293b;
        color: white;
        border-color: #1e293b;
      }

      .amount-inputs {
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      .amount-input {
        flex: 1;
        padding: 0.75rem 1rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        text-align: center;
        transition: all 0.2s ease;
      }

      .amount-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .range-separator {
        font-weight: 600;
        color: #64748b;
      }

      /* Summary Panel */
      .summary-panel {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        height: fit-content;
        position: sticky;
        top: 2rem;
      }

      .summary-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .summary-amount {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 2rem;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .amount-display {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .amount-frequency {
        font-size: 0.875rem;
        opacity: 0.9;
      }

      .confidence-indicator {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .confidence-header {
        font-size: 0.875rem;
        font-weight: 600;
        color: #166534;
        margin-bottom: 0.5rem;
      }

      .confidence-bar {
        height: 8px;
        background: #dcfce7;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 0.5rem;
      }

      .confidence-fill {
        height: 100%;
        background: #16a34a;
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .confidence-text {
        font-size: 0.75rem;
        color: #166534;
      }

      .validation-message {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .validation-text {
        font-size: 0.875rem;
        color: #166534;
        font-weight: 500;
      }

      /* Navigation Buttons */
      .nav-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 3rem;
      }

      .btn {
        padding: 0.875rem 2rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .btn-primary:hover {
        background: #059669;
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
      }

      .btn-secondary {
        background: transparent;
        color: #64748b;
        border-color: #e2e8f0;
      }

      .btn-secondary:hover {
        background: #f8fafc;
        color: #1e293b;
        border-color: #cbd5e1;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      /* Step 2 & 3 Specific Styles */
      .category-section {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 2rem;
        overflow: hidden;
      }

      .category-section.essential {
        border-color: #ef4444;
        box-shadow: 0 8px 32px rgba(239, 68, 68, 0.15);
      }

      .category-header {
        padding: 1.5rem 2rem;
        background: #f8fafc;
        border-bottom: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .category-header.essential {
        background: #fef2f2;
        border-bottom-color: #fecaca;
      }

      .category-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .category-icon {
        font-size: 1.5rem;
      }

      .category-details h3 {
        font-size: 1.125rem;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
      }

      .category-description {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .priority-badge {
        background: #ef4444;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-right: 1rem;
      }

      .category-total {
        font-size: 1.125rem;
        font-weight: 700;
        color: #10b981;
      }

      .category-content {
        padding: 2rem;
      }

      .expense-placeholder {
        text-align: center;
        padding: 3rem 2rem;
        color: #64748b;
        font-style: italic;
      }

      .add-expense-btn {
        background: #f8fafc;
        border: 2px dashed #e2e8f0;
        padding: 1rem 2rem;
        border-radius: 8px;
        color: #64748b;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        width: 100%;
      }

      .add-expense-btn:hover {
        border-color: #10b981;
        color: #10b981;
        background: #f0fdf4;
      }

      /* Goal styles */
      .goal-section {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 2rem;
        overflow: hidden;
      }

      .goal-header {
        padding: 1.5rem 2rem;
        background: #f8fafc;
        border-bottom: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .goal-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .goal-icon {
        font-size: 1.5rem;
      }

      .goal-details h3 {
        font-size: 1.125rem;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
      }

      .goal-description {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .goal-total {
        font-size: 1.125rem;
        font-weight: 700;
        color: #10b981;
      }

      .goal-content {
        padding: 2rem;
      }

      .goal-placeholder {
        text-align: center;
        padding: 3rem 2rem;
        color: #64748b;
        font-style: italic;
      }

      .add-goal-btn {
        background: #f8fafc;
        border: 2px dashed #e2e8f0;
        padding: 1rem 2rem;
        border-radius: 8px;
        color: #64748b;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        width: 100%;
      }

      .add-goal-btn:hover {
        border-color: #10b981;
        color: #10b981;
        background: #f0fdf4;
      }

      /* Expense Items */
      .expense-item {
        display: flex;
        align-items: center;
        padding: 1rem;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        margin-bottom: 0.75rem;
        transition: all 0.2s ease;
      }

      .expense-item:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
      }

      .expense-name {
        flex: 1;
        font-weight: 500;
        color: #1e293b;
        margin-right: 1rem;
      }

      .expense-amount {
        font-weight: 600;
        color: #10b981;
        margin-right: 1rem;
        min-width: 80px;
        text-align: right;
      }

      .expense-actions {
        display: flex;
        gap: 0.5rem;
      }

      .expense-btn {
        padding: 0.25rem 0.5rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .expense-btn:hover {
        border-color: #cbd5e1;
        color: #1e293b;
      }

      .expense-btn.delete:hover {
        border-color: #ef4444;
        color: #ef4444;
        background: #fef2f2;
      }

      /* Goal Items */
      .goal-item {
        display: flex;
        align-items: center;
        padding: 1rem;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        margin-bottom: 0.75rem;
        transition: all 0.2s ease;
      }

      .goal-item:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
      }

      .goal-name {
        flex: 1;
        font-weight: 500;
        color: #1e293b;
        margin-right: 1rem;
      }

      .goal-amount {
        font-weight: 600;
        color: #10b981;
        margin-right: 1rem;
        min-width: 80px;
        text-align: right;
      }

      .goal-actions {
        display: flex;
        gap: 0.5rem;
      }

      .goal-btn {
        padding: 0.25rem 0.5rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .goal-btn:hover {
        border-color: #cbd5e1;
        color: #1e293b;
      }

      .goal-btn.delete:hover {
        border-color: #ef4444;
        color: #ef4444;
        background: #fef2f2;
      }

      /* Modal for adding items */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .modal.show {
        display: flex;
      }

      .modal-content {
        background: white;
        padding: 2rem;
        border-radius: 16px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      .modal-header {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .modal-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .modal-input {
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
      }

      .modal-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .modal-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .modal-btn {
        flex: 1;
        padding: 0.75rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
      }

      .modal-btn.primary {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .modal-btn.primary:hover {
        background: #059669;
        transform: translateY(-1px);
      }

      .modal-btn.secondary {
        background: transparent;
        color: #64748b;
        border-color: #e2e8f0;
      }

      .modal-btn.secondary:hover {
        background: #f8fafc;
        color: #1e293b;
      }

      /* Hidden steps */
      .step {
        display: none;
      }

      .step.active {
        display: block;
        animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Responsive */
      @media (max-width: 1200px) {
        .form-grid {
          grid-template-columns: 1fr;
          gap: 2rem;
        }

        .summary-panel {
          position: static;
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
          transition: transform 0.3s ease;
        }

        .main-content {
          margin-left: 0;
          width: 100vw;
          max-width: 100vw;
          padding: 1rem;
        }

        .step-title {
          font-size: 2rem;
        }

        .nav-buttons {
          flex-direction: column;
          align-items: center;
        }

        .btn {
          width: 200px;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="logo-area">
          <span class="logo-icon">💰</span>
          <div>
            <div class="logo-text">Budget Planner</div>
            <div class="breadcrumb">Create Budget</div>
          </div>
        </div>
        <div class="header-nav">
          <a href="#" class="nav-item active">Create Budget</a>
          <a href="#" class="nav-item">My Budget</a>
          <a href="#" class="nav-item">Goals</a>
          <a href="#" class="nav-item">Scenarios</a>
        </div>
      </header>

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-section">
          <div class="sidebar-title">Budget Creation</div>
          <div class="step-progress">
            <div class="step-item active" id="step1-indicator">
              <div class="step-number">1</div>
              <div class="step-details">
                <h4>Income</h4>
                <div class="step-description">Tell us what you earn</div>
              </div>
            </div>
            <div class="step-item" id="step2-indicator">
              <div class="step-number">2</div>
              <div class="step-details">
                <h4>Expenses</h4>
                <div class="step-description">How you spend it</div>
              </div>
            </div>
            <div class="step-item" id="step3-indicator">
              <div class="step-number">3</div>
              <div class="step-details">
                <h4>Goals</h4>
                <div class="step-description">What you want to achieve</div>
              </div>
            </div>
          </div>
        </div>

        <div class="sidebar-section">
          <div id="sidebar-content">
            <!-- Dynamic content based on current step -->
            <div class="running-total" id="income-total" style="display: none">
              <div class="total-title">Monthly Income</div>
              <div class="total-amount">£0</div>
              <div class="total-status">Add your income sources</div>
            </div>

            <div class="running-total" id="expense-total" style="display: none">
              <div class="total-title">Budget Allocation</div>
              <div class="total-amount">£0 of £0</div>
              <div class="total-status">Start with essentials</div>
            </div>

            <div class="running-total" id="goal-total" style="display: none">
              <div class="total-title">Available for Goals</div>
              <div class="total-amount">£0</div>
              <div class="total-status">Allocate your surplus</div>
            </div>
          </div>
        </div>

        <div class="sidebar-section">
          <div class="tips-section">
            <div class="tips-title">Tips:</div>
            <div id="step-tips">
              <div class="tip">Use ranges if your income varies</div>
              <div class="tip">Include all regular income sources</div>
              <div class="tip">Don't worry about being exact</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Step 1: Income -->
        <div class="step active" id="step1">
          <div class="step-container">
            <div class="step-header">
              <h1 class="step-title">Tell us about your income</h1>
              <p class="step-subtitle">
                Let's start with how much money comes in each month
              </p>
            </div>

            <div class="form-grid">
              <div class="form-content">
                <!-- Primary Income -->
                <div class="income-source primary">
                  <div class="source-header">
                    <div class="source-title">
                      💼 Your Main Income
                      <span class="source-badge">PRIMARY</span>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Type of income:</label>
                    <div class="type-selector">
                      <button class="type-option active">Employment</button>
                      <button class="type-option">Self-Employed</button>
                      <button class="type-option">Benefits</button>
                      <button class="type-option">Other</button>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Monthly amount (after tax)</label>
                    <div class="amount-section">
                      <div class="amount-type-toggle">
                        <button
                          class="amount-type-btn active"
                          onclick="toggleAmountType(this, 'single')"
                        >
                          Exact Amount
                        </button>
                        <button
                          class="amount-type-btn"
                          onclick="toggleAmountType(this, 'range')"
                        >
                          Range
                        </button>
                      </div>
                      <div class="amount-inputs" id="amount-inputs">
                        <input
                          type="text"
                          class="amount-input"
                          placeholder="£2,500"
                          id="single-amount"
                          oninput="updateIncome()"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Secondary Income -->
                <div
                  class="income-source"
                  id="secondary-income"
                  style="display: none"
                >
                  <div class="source-header">
                    <div class="source-title">
                      💡 Additional Income
                      <span class="source-badge secondary">SECONDARY</span>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Type of income:</label>
                    <div class="type-selector">
                      <button class="type-option">Part-time Job</button>
                      <button class="type-option active">Freelance</button>
                      <button class="type-option">Side Business</button>
                      <button class="type-option">Other</button>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Monthly amount (after tax)</label>
                    <div class="amount-section">
                      <div class="amount-type-toggle">
                        <button class="amount-type-btn">Exact Amount</button>
                        <button class="amount-type-btn active">Range</button>
                      </div>
                      <div class="amount-inputs">
                        <input
                          type="text"
                          class="amount-input"
                          placeholder="£200"
                          oninput="updateIncome()"
                        />
                        <span class="range-separator">to</span>
                        <input
                          type="text"
                          class="amount-input"
                          placeholder="£600"
                          oninput="updateIncome()"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <button
                  class="add-expense-btn"
                  onclick="showSecondaryIncome()"
                  id="add-income-btn"
                >
                  + Add Another Income Source
                </button>
              </div>

              <div class="summary-panel">
                <div class="summary-title">Your Monthly Income</div>
                <div class="summary-amount">
                  <div class="amount-display" id="income-display">£0</div>
                  <div class="amount-frequency">per month</div>
                </div>

                <div class="confidence-indicator">
                  <div class="confidence-header">
                    Income Confidence:
                    <span id="confidence-level">GETTING STARTED</span>
                  </div>
                  <div class="confidence-bar">
                    <div
                      class="confidence-fill"
                      id="confidence-fill"
                      style="width: 0%"
                    ></div>
                  </div>
                  <div class="confidence-text" id="confidence-text">
                    Add your income to see confidence level
                  </div>
                </div>

                <div
                  class="validation-message"
                  id="validation-message"
                  style="display: none"
                >
                  <div class="validation-text">
                    ✓ Great! You have a solid income foundation for budgeting
                  </div>
                </div>

                <button
                  class="btn btn-primary"
                  onclick="nextStep()"
                  id="continue-btn"
                  disabled
                >
                  CONTINUE TO EXPENSES →
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 2: Expenses -->
        <div class="step" id="step2">
          <div class="step-container">
            <div class="step-header">
              <h1 class="step-title">How do you spend your money?</h1>
              <p class="step-subtitle">
                Add your expenses to each category - start with the essentials
              </p>
            </div>

            <div class="form-grid">
              <div class="form-content">
                <!-- Essentials Category -->
                <div class="category-section essential">
                  <div class="category-header essential">
                    <div class="category-info">
                      <span class="category-icon">🏠</span>
                      <div class="category-details">
                        <h3>ESSENTIALS</h3>
                        <div class="category-description">
                          Rent, utilities, insurance, minimum debt payments
                        </div>
                      </div>
                    </div>
                    <div style="display: flex; align-items: center">
                      <div class="priority-badge">PRIORITY</div>
                      <div class="category-total" id="essentials-total">
                        £0/month
                      </div>
                    </div>
                  </div>
                  <div class="category-content">
                    <div
                      class="expense-placeholder"
                      id="essentials-placeholder"
                    >
                      No expenses added yet. These are your most important
                      costs.
                    </div>
                    <div
                      class="expense-list"
                      id="essentials-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('essentials')"
                    >
                      + Add Essential Expense
                    </button>
                  </div>
                </div>

                <!-- Basics Category -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">🛒</span>
                      <div class="category-details">
                        <h3>BASICS</h3>
                        <div class="category-description">
                          Food, transport, essential clothing
                        </div>
                      </div>
                    </div>
                    <div class="category-total" id="basics-total">£0/month</div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder" id="basics-placeholder">
                      Add your basic living expenses here.
                    </div>
                    <div
                      class="expense-list"
                      id="basics-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('basics')"
                    >
                      + Add Basic Expense
                    </button>
                  </div>
                </div>

                <!-- Wants Category -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">🎯</span>
                      <div class="category-details">
                        <h3>WANTS</h3>
                        <div class="category-description">
                          Entertainment, dining out, hobbies
                        </div>
                      </div>
                    </div>
                    <div class="category-total" id="wants-total">£0/month</div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder" id="wants-placeholder">
                      Add your discretionary spending here.
                    </div>
                    <div
                      class="expense-list"
                      id="wants-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('wants')"
                    >
                      + Add Want/Entertainment
                    </button>
                  </div>
                </div>

                <!-- Virtual Fund -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">⚡</span>
                      <div class="category-details">
                        <h3>VIRTUAL FUND</h3>
                        <div class="category-description">
                          Unexpected expenses safety net
                        </div>
                      </div>
                    </div>
                    <div class="category-total" id="virtual-total">
                      £0/month
                    </div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder" id="virtual-placeholder">
                      This fund covers unexpected costs like car repairs or
                      medical bills.
                    </div>
                    <div
                      class="expense-list"
                      id="virtual-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('virtual')"
                    >
                      + Add Virtual Fund Item
                    </button>
                  </div>
                </div>
              </div>

              <div class="summary-panel">
                <div class="summary-title">Budget Progress</div>
                <div class="summary-amount">
                  <div class="amount-display">£0 of £0</div>
                  <div class="amount-frequency">allocated</div>
                </div>

                <div class="confidence-indicator">
                  <div class="confidence-header">
                    Remaining:
                    <span style="color: #10b981; font-weight: 700">£0</span>
                  </div>
                  <div class="confidence-text">
                    Start with your essential expenses first
                  </div>
                </div>

                <div class="validation-message" style="display: none">
                  <div class="validation-text">
                    ✓ Your budget is balanced and ready for goals
                  </div>
                </div>

                <button
                  class="btn btn-primary"
                  onclick="nextStep()"
                  id="step2-continue-btn"
                  disabled
                >
                  SET YOUR GOALS →
                </button>
              </div>
            </div>

            <div class="nav-buttons">
              <button class="btn btn-secondary" onclick="prevStep()">
                ← BACK TO INCOME
              </button>
            </div>
          </div>
        </div>

        <!-- Step 3: Goals -->
        <div class="step" id="step3">
          <div class="step-container">
            <div class="step-header">
              <h1 class="step-title">What are your goals?</h1>
              <p class="step-subtitle">
                Let's put your monthly surplus to work for your future
              </p>
            </div>

            <div class="form-grid">
              <div class="form-content">
                <!-- Financial Freedom Section -->
                <div class="goal-section">
                  <div class="goal-header">
                    <div class="goal-info">
                      <span class="goal-icon">🆓</span>
                      <div class="goal-details">
                        <h3>FINANCIAL FREEDOM</h3>
                        <div class="goal-description">
                          Clear outstanding balances and reduce monthly
                          commitments
                        </div>
                      </div>
                    </div>
                    <div class="goal-total" id="freedom-total">£0/month</div>
                  </div>
                  <div class="goal-content">
                    <div class="goal-placeholder" id="freedom-placeholder">
                      Add any debts or balances you'd like to clear. This
                      creates more monthly freedom for you.
                    </div>
                    <div
                      class="goal-list"
                      id="freedom-list"
                      style="display: none"
                    ></div>
                    <button class="add-goal-btn" onclick="addGoal('freedom')">
                      + Add Balance to Clear
                    </button>
                  </div>
                </div>

                <!-- Emergency Fund Section -->
                <div class="goal-section">
                  <div class="goal-header">
                    <div class="goal-info">
                      <span class="goal-icon">🛡️</span>
                      <div class="goal-details">
                        <h3>EMERGENCY FUND</h3>
                        <div class="goal-description">
                          Safety net for unexpected expenses
                        </div>
                      </div>
                    </div>
                    <div class="goal-total" id="emergency-total">£0/month</div>
                  </div>
                  <div class="goal-content">
                    <div class="goal-placeholder" id="emergency-placeholder">
                      Build a financial safety net for peace of mind. Most
                      people aim for 3-6 months of expenses.
                    </div>
                    <div
                      class="goal-list"
                      id="emergency-list"
                      style="display: none"
                    ></div>
                    <button class="add-goal-btn" onclick="addGoal('emergency')">
                      + Add Emergency Goal
                    </button>
                  </div>
                </div>

                <!-- Savings Goals Section -->
                <div class="goal-section">
                  <div class="goal-header">
                    <div class="goal-info">
                      <span class="goal-icon">🎯</span>
                      <div class="goal-details">
                        <h3>SAVINGS GOALS</h3>
                        <div class="goal-description">
                          Holidays, purchases, and future plans
                        </div>
                      </div>
                    </div>
                    <div class="goal-total" id="savings-total">£0/month</div>
                  </div>
                  <div class="goal-content">
                    <div class="goal-placeholder" id="savings-placeholder">
                      What would you like to save for? Holidays, a new car, home
                      improvements, or something else?
                    </div>
                    <div
                      class="goal-list"
                      id="savings-list"
                      style="display: none"
                    ></div>
                    <button class="add-goal-btn" onclick="addGoal('savings')">
                      + Add Savings Goal
                    </button>
                  </div>
                </div>
              </div>

              <div class="summary-panel">
                <div class="summary-title">Goal Summary</div>
                <div class="summary-amount">
                  <div class="amount-display">£0</div>
                  <div class="amount-frequency">allocated to goals</div>
                </div>

                <div class="confidence-indicator">
                  <div class="confidence-header">
                    Available:
                    <span style="color: #10b981; font-weight: 700">£0</span>
                  </div>
                  <div class="confidence-text">
                    Start adding goals to see your progress
                  </div>
                </div>

                <div class="validation-message" style="display: none">
                  <div class="validation-text">
                    ✓ Perfect! You're using your full surplus to work towards
                    your goals
                  </div>
                </div>

                <button
                  class="btn btn-primary"
                  onclick="completeBudget()"
                  id="step3-continue-btn"
                  disabled
                >
                  CREATE MY BUDGET
                </button>
              </div>
            </div>

            <div class="nav-buttons">
              <button class="btn btn-secondary" onclick="prevStep()">
                ← BACK TO EXPENSES
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Modal for adding expenses/goals -->
    <div class="modal" id="addModal">
      <div class="modal-content">
        <div class="modal-header" id="modalTitle">Add Expense</div>
        <div class="modal-form">
          <input
            type="text"
            class="modal-input"
            id="itemName"
            placeholder="Expense name (e.g., Rent)"
          />
          <input
            type="text"
            class="modal-input"
            id="itemAmount"
            placeholder="Amount (e.g., £850)"
          />
        </div>
        <div class="modal-actions">
          <button class="modal-btn secondary" onclick="closeModal()">
            Cancel
          </button>
          <button class="modal-btn primary" onclick="saveItem()">
            Add Item
          </button>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 1;
      let totalIncome = 0;
      let totalExpenses = 0;
      let totalGoals = 0;
      let currentCategory = '';
      let expenses = {
        essentials: [],
        basics: [],
        wants: [],
        virtual: []
      };
      let goals = {
        freedom: [],
        emergency: [],
        savings: []
      };

      function toggleAmountType(button, type) {
        // Remove active class from siblings
        button.parentElement
          .querySelectorAll('.amount-type-btn')
          .forEach((btn) => {
            btn.classList.remove('active');
          });
        button.classList.add('active');

        // Update input fields
        const container = document.getElementById('amount-inputs');
        if (type === 'range') {
          container.innerHTML = `
            <input type="text" class="amount-input" placeholder="£200" oninput="updateIncome()">
            <span class="range-separator">to</span>
            <input type="text" class="amount-input" placeholder="£600" oninput="updateIncome()">
          `;
        } else {
          container.innerHTML = `
            <input type="text" class="amount-input" placeholder="£2,500" id="single-amount" oninput="updateIncome()">
          `;
        }
      }

      function showSecondaryIncome() {
        document.getElementById('secondary-income').style.display = 'block';
        document.getElementById('add-income-btn').style.display = 'none';
      }

      function updateIncome() {
        const inputs = document.querySelectorAll('#step1 .amount-input');
        let total = 0;
        let hasValue = false;

        inputs.forEach((input) => {
          const value = parseFloat(input.value.replace(/[£,]/g, '')) || 0;
          if (value > 0) {
            hasValue = true;
            total += value;
          }
        });

        totalIncome = total;

        // Update display
        const display = document.getElementById('income-display');
        const continueBtn = document.getElementById('continue-btn');
        const validation = document.getElementById('validation-message');
        const confidence = document.getElementById('confidence-level');
        const confidenceFill = document.getElementById('confidence-fill');
        const confidenceText = document.getElementById('confidence-text');

        if (hasValue) {
          display.textContent = `£${total.toLocaleString()}`;
          continueBtn.disabled = false;
          validation.style.display = 'block';

          if (total >= 1000) {
            confidence.textContent = 'EXCELLENT';
            confidenceFill.style.width = '90%';
            confidenceText.textContent =
              'Strong and reliable income foundation';
          } else if (total >= 500) {
            confidence.textContent = 'GOOD';
            confidenceFill.style.width = '70%';
            confidenceText.textContent = 'Solid income for basic budgeting';
          } else {
            confidence.textContent = 'GETTING STARTED';
            confidenceFill.style.width = '40%';
            confidenceText.textContent =
              'Every income level can benefit from budgeting';
          }
        } else {
          display.textContent = '£0';
          continueBtn.disabled = true;
          validation.style.display = 'none';
          confidence.textContent = 'GETTING STARTED';
          confidenceFill.style.width = '0%';
          confidenceText.textContent =
            'Add your income to see confidence level';
        }

        updateSidebarTotal();
      }

      function addExpense(category) {
        currentCategory = category;
        const modal = document.getElementById('addModal');
        const title = document.getElementById('modalTitle');
        const nameInput = document.getElementById('itemName');
        const amountInput = document.getElementById('itemAmount');

        // Set modal title and placeholders based on category
        const categoryInfo = {
          essentials: {
            title: 'Add Essential Expense',
            namePlaceholder: 'e.g., Rent, Utilities',
            amountPlaceholder: 'e.g., £850'
          },
          basics: {
            title: 'Add Basic Expense',
            namePlaceholder: 'e.g., Groceries, Transport',
            amountPlaceholder: 'e.g., £400'
          },
          wants: {
            title: 'Add Want/Entertainment',
            namePlaceholder: 'e.g., Netflix, Dining Out',
            amountPlaceholder: 'e.g., £50'
          },
          virtual: {
            title: 'Add Virtual Fund Item',
            namePlaceholder: 'e.g., Car Repairs, Emergency',
            amountPlaceholder: 'e.g., £100'
          }
        };

        title.textContent = categoryInfo[category].title;
        nameInput.placeholder = categoryInfo[category].namePlaceholder;
        amountInput.placeholder = categoryInfo[category].amountPlaceholder;
        nameInput.value = '';
        amountInput.value = '';

        modal.classList.add('show');
        nameInput.focus();
      }

      function addGoal(category) {
        currentCategory = category;
        const modal = document.getElementById('addModal');
        const title = document.getElementById('modalTitle');
        const nameInput = document.getElementById('itemName');
        const amountInput = document.getElementById('itemAmount');

        // Set modal title and placeholders based on goal type
        const goalInfo = {
          freedom: {
            title: 'Add Balance to Clear',
            namePlaceholder: 'e.g., Credit Card, Personal Loan',
            amountPlaceholder: 'e.g., £200/month'
          },
          emergency: {
            title: 'Add Emergency Fund',
            namePlaceholder: 'e.g., Emergency Fund',
            amountPlaceholder: 'e.g., £300/month'
          },
          savings: {
            title: 'Add Savings Goal',
            namePlaceholder: 'e.g., Holiday Fund, New Car',
            amountPlaceholder: 'e.g., £200/month'
          }
        };

        title.textContent = goalInfo[category].title;
        nameInput.placeholder = goalInfo[category].namePlaceholder;
        amountInput.placeholder = goalInfo[category].amountPlaceholder;
        nameInput.value = '';
        amountInput.value = '';

        modal.classList.add('show');
        nameInput.focus();
      }

      function closeModal() {
        document.getElementById('addModal').classList.remove('show');
      }

      function saveItem() {
        const nameInput = document.getElementById('itemName');
        const amountInput = document.getElementById('itemAmount');
        const name = nameInput.value.trim();
        const amountText = amountInput.value.trim();

        if (!name || !amountText) {
          alert('Please enter both a name and amount');
          return;
        }

        const amount = parseFloat(amountText.replace(/[£,]/g, '')) || 0;
        if (amount <= 0) {
          alert('Please enter a valid amount');
          return;
        }

        const item = { name, amount, amountText };

        // Add to appropriate category
        if (currentStep === 2) {
          expenses[currentCategory].push(item);
          updateExpenseDisplay(currentCategory);
          updateExpenseTotals();
        } else if (currentStep === 3) {
          goals[currentCategory].push(item);
          updateGoalDisplay(currentCategory);
          updateGoalTotals();
        }

        closeModal();
        updateSidebarTotal();
        updateContinueButton();
      }

      function updateExpenseDisplay(category) {
        const list = document.getElementById(`${category}-list`);
        const placeholder = document.getElementById(`${category}-placeholder`);
        const items = expenses[category];

        if (items.length > 0) {
          placeholder.style.display = 'none';
          list.style.display = 'block';

          list.innerHTML = items
            .map(
              (item, index) => `
            <div class="expense-item">
              <div class="expense-name">${item.name}</div>
              <div class="expense-amount">${item.amountText}</div>
              <div class="expense-actions">
                <button class="expense-btn delete" onclick="removeExpense('${category}', ${index})">Delete</button>
              </div>
            </div>
          `
            )
            .join('');
        } else {
          placeholder.style.display = 'block';
          list.style.display = 'none';
        }
      }

      function updateGoalDisplay(category) {
        const list = document.getElementById(`${category}-list`);
        const placeholder = document.getElementById(`${category}-placeholder`);
        const items = goals[category];

        if (items.length > 0) {
          placeholder.style.display = 'none';
          list.style.display = 'block';

          list.innerHTML = items
            .map(
              (item, index) => `
            <div class="goal-item">
              <div class="goal-name">${item.name}</div>
              <div class="goal-amount">${item.amountText}</div>
              <div class="goal-actions">
                <button class="goal-btn delete" onclick="removeGoal('${category}', ${index})">Delete</button>
              </div>
            </div>
          `
            )
            .join('');
        } else {
          placeholder.style.display = 'block';
          list.style.display = 'none';
        }
      }

      function removeExpense(category, index) {
        expenses[category].splice(index, 1);
        updateExpenseDisplay(category);
        updateExpenseTotals();
        updateSidebarTotal();
        updateContinueButton();
      }

      function removeGoal(category, index) {
        goals[category].splice(index, 1);
        updateGoalDisplay(category);
        updateGoalTotals();
        updateSidebarTotal();
        updateContinueButton();
      }

      function updateExpenseTotals() {
        // Calculate totals for each category
        const categoryTotals = {};
        let grandTotal = 0;

        Object.keys(expenses).forEach((category) => {
          const total = expenses[category].reduce(
            (sum, item) => sum + item.amount,
            0
          );
          categoryTotals[category] = total;
          grandTotal += total;

          // Update category total display
          document.getElementById(`${category}-total`).textContent =
            `£${total.toLocaleString()}/month`;
        });

        totalExpenses = grandTotal;

        // Update step 2 summary
        if (currentStep === 2) {
          const remaining = totalIncome - totalExpenses;
          document.querySelector('#step2 .amount-display').textContent =
            `£${totalExpenses.toLocaleString()} of £${totalIncome.toLocaleString()}`;
          document.querySelector('#step2 .confidence-header').innerHTML =
            `Remaining: <span style="color: #10b981; font-weight: 700;">£${remaining.toLocaleString()}</span>`;

          if (remaining >= 0) {
            document.querySelector('#step2 .confidence-text').textContent =
              remaining > 0
                ? 'Great! You have money left for goals'
                : 'Perfect! Your budget is balanced';
          } else {
            document.querySelector('#step2 .confidence-text').textContent =
              "You're over budget - try reducing some expenses";
          }
        }
      }

      function updateGoalTotals() {
        // Calculate totals for each goal category
        const categoryTotals = {};
        let grandTotal = 0;

        Object.keys(goals).forEach((category) => {
          const total = goals[category].reduce(
            (sum, item) => sum + item.amount,
            0
          );
          categoryTotals[category] = total;
          grandTotal += total;

          // Update category total display
          document.getElementById(`${category}-total`).textContent =
            `£${total.toLocaleString()}/month`;
        });

        totalGoals = grandTotal;

        // Update step 3 summary
        if (currentStep === 3) {
          const available = totalIncome - totalExpenses - totalGoals;
          document.querySelector('#step3 .amount-display').textContent =
            `£${totalGoals.toLocaleString()}`;
          document.querySelector('#step3 .confidence-header').innerHTML =
            `Available: <span style="color: #10b981; font-weight: 700;">£${available.toLocaleString()}</span>`;

          if (available >= 0) {
            document.querySelector('#step3 .confidence-text').textContent =
              available > 0
                ? 'You can add more goals if you want'
                : "Perfect! You're using your full surplus";
          } else {
            document.querySelector('#step3 .confidence-text').textContent =
              "You're over budget - try reducing some goal amounts";
          }
        }
      }

      function updateContinueButton() {
        if (currentStep === 2) {
          const hasExpenses = Object.values(expenses).some(
            (category) => category.length > 0
          );
          const remaining = totalIncome - totalExpenses;
          const continueBtn = document.getElementById('step2-continue-btn');
          const validation = document.querySelector(
            '#step2 .validation-message'
          );

          continueBtn.disabled = !hasExpenses || remaining < 0;

          if (hasExpenses && remaining >= 0) {
            validation.style.display = 'block';
          } else {
            validation.style.display = 'none';
          }
        } else if (currentStep === 3) {
          const hasGoals = Object.values(goals).some(
            (category) => category.length > 0
          );
          const available = totalIncome - totalExpenses - totalGoals;
          const continueBtn = document.getElementById('step3-continue-btn');
          const validation = document.querySelector(
            '#step3 .validation-message'
          );

          continueBtn.disabled = available < 0;

          if (available >= 0) {
            validation.style.display = 'block';
          } else {
            validation.style.display = 'none';
          }
        }
      }

      function updateSidebarTotal() {
        const incomeTotal = document.getElementById('income-total');
        const expenseTotal = document.getElementById('expense-total');
        const goalTotal = document.getElementById('goal-total');

        // Hide all totals first
        incomeTotal.style.display = 'none';
        expenseTotal.style.display = 'none';
        goalTotal.style.display = 'none';

        if (currentStep === 1) {
          incomeTotal.style.display = 'block';
          incomeTotal.querySelector('.total-amount').textContent =
            `£${totalIncome.toLocaleString()}`;
          if (totalIncome > 0) {
            incomeTotal.querySelector('.total-status').textContent =
              'Ready for next step';
          }
        } else if (currentStep === 2) {
          expenseTotal.style.display = 'block';
          const remaining = totalIncome - totalExpenses;
          expenseTotal.querySelector('.total-amount').textContent =
            `£${totalExpenses.toLocaleString()} of £${totalIncome.toLocaleString()}`;
          expenseTotal.querySelector('.total-status').textContent =
            `£${remaining.toLocaleString()} remaining`;
        } else if (currentStep === 3) {
          goalTotal.style.display = 'block';
          const available = totalIncome - totalExpenses - totalGoals;
          goalTotal.querySelector('.total-amount').textContent =
            `£${available.toLocaleString()}`;
          goalTotal.querySelector('.total-status').textContent =
            'Available for new goals';
        }
      }

      function updateStepIndicators() {
        const indicators = [
          'step1-indicator',
          'step2-indicator',
          'step3-indicator'
        ];

        indicators.forEach((id, index) => {
          const indicator = document.getElementById(id);
          const stepNum = index + 1;

          indicator.classList.remove('active', 'completed');

          if (stepNum < currentStep) {
            indicator.classList.add('completed');
            indicator.querySelector('.step-number').textContent = '✓';
          } else if (stepNum === currentStep) {
            indicator.classList.add('active');
            indicator.querySelector('.step-number').textContent = stepNum;
          } else {
            indicator.querySelector('.step-number').textContent = stepNum;
          }
        });
      }

      function updateTips() {
        const tipsContainer = document.getElementById('step-tips');
        const tips = {
          1: [
            'Use ranges if your income varies',
            'Include all regular income sources',
            "Don't worry about being exact"
          ],
          2: [
            'Start with essentials first',
            'Use ranges for variable costs',
            'Include annual costs in Virtual Fund'
          ],
          3: [
            'Start with what feels most important',
            'Every step forward is progress',
            'Drag to reorder by priority'
          ]
        };

        tipsContainer.innerHTML = tips[currentStep]
          .map((tip) => `<div class="tip">${tip}</div>`)
          .join('');
      }

      function nextStep() {
        if (currentStep < 3) {
          // Hide current step
          document
            .getElementById(`step${currentStep}`)
            .classList.remove('active');

          currentStep++;

          // Show next step
          document.getElementById(`step${currentStep}`).classList.add('active');

          updateStepIndicators();
          updateSidebarTotal();
          updateTips();
          updateContinueButton();
        }
      }

      function prevStep() {
        if (currentStep > 1) {
          // Hide current step
          document
            .getElementById(`step${currentStep}`)
            .classList.remove('active');

          currentStep--;

          // Show previous step
          document.getElementById(`step${currentStep}`).classList.add('active');

          updateStepIndicators();
          updateSidebarTotal();
          updateTips();
          updateContinueButton();
        }
      }

      function completeBudget() {
        alert(
          "🎉 Congratulations! Your budget has been created successfully.\n\nYou'll now be taken to your dashboard where you can see how your finances are working for you."
        );
        // In a real app, this would redirect to the main dashboard
      }

      // Close modal when clicking outside
      document
        .getElementById('addModal')
        .addEventListener('click', function (e) {
          if (e.target === this) {
            closeModal();
          }
        });

      // Handle Enter key in modal
      document.addEventListener('keydown', function (e) {
        if (
          e.key === 'Enter' &&
          document.getElementById('addModal').classList.contains('show')
        ) {
          saveItem();
        } else if (e.key === 'Escape') {
          closeModal();
        }
      });

      // Initialize
      updateStepIndicators();
      updateSidebarTotal();
      updateTips();
    </script>
  </body>
</html>
