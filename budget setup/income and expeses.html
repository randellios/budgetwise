<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Budget Planner - Create Your Budget</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          Roboto,
          sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        color: #1e293b;
        line-height: 1.6;
        overflow-x: hidden;
      }

      .app-container {
        display: flex;
        min-height: 100vh;
      }

      /* Header */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 70px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 2rem;
        z-index: 100;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .logo-area {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .logo-icon {
        font-size: 1.75rem;
      }

      .logo-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1e293b;
      }

      .breadcrumb {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .header-nav {
        display: flex;
        gap: 1rem;
      }

      .nav-item {
        padding: 0.5rem 1rem;
        border-radius: 6px;
        font-weight: 500;
        color: #64748b;
        text-decoration: none;
        transition: all 0.2s ease;
      }

      .nav-item.active {
        background: #1e293b;
        color: white;
      }

      .nav-item:hover:not(.active) {
        background: rgba(241, 245, 249, 0.8);
        color: #1e293b;
      }

      /* Sidebar */
      .sidebar {
        width: 320px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-right: 1px solid rgba(226, 232, 240, 0.8);
        position: fixed;
        left: 0;
        top: 70px;
        bottom: 0;
        overflow-y: auto;
        z-index: 50;
        display: flex;
        flex-direction: column;
      }

      .sidebar-section {
        padding: 1.5rem;
        border-bottom: 1px solid rgba(226, 232, 240, 0.5);
      }

      .sidebar-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 1rem;
      }

      /* Step Progress */
      .step-progress {
        margin-bottom: 1.5rem;
      }

      .step-item {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        padding: 0.75rem;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .step-item.active {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .step-item.completed {
        background: rgba(16, 185, 129, 0.1);
        color: #059669;
      }

      .step-number {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-weight: 700;
        font-size: 0.875rem;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
      }

      .step-item.active .step-number {
        background: rgba(255, 255, 255, 0.9);
        color: #059669;
        border-color: rgba(255, 255, 255, 0.9);
      }

      .step-item.completed .step-number {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .step-details h4 {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .step-description {
        font-size: 0.75rem;
        opacity: 0.8;
      }

      /* Running Total */
      .running-total {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .total-title {
        font-size: 0.875rem;
        opacity: 0.9;
        margin-bottom: 0.5rem;
      }

      .total-amount {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .total-status {
        font-size: 0.75rem;
        opacity: 0.9;
      }

      /* Tips */
      .tips-section {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid rgba(226, 232, 240, 0.8);
      }

      .tips-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.75rem;
      }

      .tip {
        font-size: 0.75rem;
        color: #64748b;
        margin-bottom: 0.5rem;
        padding-left: 1rem;
        position: relative;
      }

      .tip:before {
        content: '💡';
        position: absolute;
        left: 0;
        top: 0;
      }

      /* Main Content */
      .main-content {
        margin-left: 320px;
        margin-top: 70px;
        padding: 2rem;
        min-height: calc(100vh - 70px);
        max-width: calc(100vw - 320px);
        width: calc(100vw - 320px);
      }

      /* Step Container */
      .step-container {
        max-width: 1152px;
        margin: 0 auto;
      }

      .step-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .step-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 0.75rem;
      }

      .step-subtitle {
        font-size: 1.125rem;
        color: #64748b;
        max-width: 600px;
        margin: 0 auto;
      }

      /* Form Styles */
      .form-grid {
        display: flex;
        gap: 3rem;
        margin-bottom: 3rem;
        align-items: flex-start;
      }

      .form-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        flex: 1;
      }

      .income-source {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
      }

      .income-source.primary {
        border-color: #10b981;
        box-shadow: 0 8px 32px rgba(16, 185, 129, 0.15);
      }

      .income-source:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      .source-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
      }

      .source-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.125rem;
        font-weight: 600;
        color: #1e293b;
      }

      .source-badge {
        background: #10b981;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .source-badge.secondary {
        background: #64748b;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.5rem;
        display: block;
      }

      .type-selector {
        display: flex;
        background: #f1f5f9;
        border-radius: 8px;
        padding: 0.25rem;
        margin-bottom: 1rem;
      }

      .type-option {
        flex: 1;
        padding: 0.5rem 1rem;
        background: transparent;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.875rem;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .type-option.active {
        background: white;
        color: #1e293b;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .amount-section {
        background: #f8fafc;
        padding: 1.5rem;
        border-radius: 12px;
        border: 2px solid #e2e8f0;
      }

      .amount-type-toggle {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
      }

      .amount-type-btn {
        padding: 0.5rem 1rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
      }

      .amount-type-btn.active {
        background: #1e293b;
        color: white;
        border-color: #1e293b;
      }

      .amount-inputs {
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      .amount-input {
        flex: 1;
        padding: 0.75rem 1rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        text-align: center;
        transition: all 0.2s ease;
      }

      .amount-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .range-separator {
        font-weight: 600;
        color: #64748b;
      }

      .add-source-btn {
        background: #f8fafc;
        border: 2px dashed #e2e8f0;
        padding: 1rem 2rem;
        border-radius: 8px;
        color: #64748b;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        width: 100%;
      }

      .add-source-btn:hover {
        border-color: #10b981;
        color: #10b981;
        background: #f0fdf4;
      }

      /* Summary Panel */
      .summary-panel {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        height: fit-content;
        position: sticky;
        top: 2rem;
        width: 400px;
        flex-shrink: 0;
      }

      .summary-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .summary-amount {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 2rem;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .amount-display {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .amount-frequency {
        font-size: 0.875rem;
        opacity: 0.9;
      }

      .allocation-progress {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .progress-header {
        font-size: 0.875rem;
        font-weight: 600;
        color: #166534;
        margin-bottom: 0.5rem;
      }

      .progress-bar {
        height: 8px;
        background: #dcfce7;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 0.5rem;
      }

      .progress-fill {
        height: 100%;
        background: #16a34a;
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .progress-text {
        font-size: 0.75rem;
        color: #166534;
      }

      .confidence-indicator {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .confidence-header {
        font-size: 0.875rem;
        font-weight: 600;
        color: #166534;
        margin-bottom: 0.5rem;
      }

      .confidence-bar {
        height: 8px;
        background: #dcfce7;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 0.5rem;
      }

      .confidence-fill {
        height: 100%;
        background: #16a34a;
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .confidence-text {
        font-size: 0.75rem;
        color: #166534;
      }

      .validation-message {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .validation-text {
        font-size: 0.875rem;
        color: #166534;
        font-weight: 500;
      }

      /* Navigation Buttons */
      .nav-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 3rem;
      }

      .btn {
        padding: 0.875rem 2rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .btn-primary:hover {
        background: #059669;
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
      }

      .btn-secondary {
        background: transparent;
        color: #64748b;
        border-color: #e2e8f0;
      }

      .btn-secondary:hover {
        background: #f8fafc;
        color: #1e293b;
        border-color: #cbd5e1;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      /* Step 2 & 3 Specific Styles */
      .category-section {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 2rem;
        overflow: hidden;
      }

      .category-section.essential {
        border-color: #ef4444;
        box-shadow: 0 8px 32px rgba(239, 68, 68, 0.15);
      }

      .category-header {
        padding: 1.5rem 2rem;
        background: #f8fafc;
        border-bottom: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .category-header.essential {
        background: #fef2f2;
        border-bottom-color: #fecaca;
      }

      .category-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .category-icon {
        font-size: 1.5rem;
      }

      .category-details h3 {
        font-size: 1.125rem;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
      }

      .category-description {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .priority-badge {
        background: #ef4444;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-right: 1rem;
      }

      .category-total {
        font-size: 1.125rem;
        font-weight: 700;
        color: #10b981;
      }

      .category-content {
        padding: 2rem;
      }

      .expense-placeholder {
        text-align: center;
        padding: 3rem 2rem;
        color: #64748b;
        font-style: italic;
      }

      .add-expense-btn {
        background: #f8fafc;
        border: 2px dashed #e2e8f0;
        padding: 1rem 2rem;
        border-radius: 8px;
        color: #64748b;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        width: 100%;
      }

      .add-expense-btn:hover {
        border-color: #10b981;
        color: #10b981;
        background: #f0fdf4;
      }

      /* Expense Items */
      .expense-item {
        display: flex;
        align-items: center;
        padding: 1rem;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        margin-bottom: 0.75rem;
        transition: all 0.2s ease;
      }

      .expense-item:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
      }

      .expense-name {
        flex: 1;
        font-weight: 500;
        color: #1e293b;
        margin-right: 1rem;
      }

      .expense-amount {
        font-weight: 600;
        color: #10b981;
        margin-right: 1rem;
        min-width: 120px;
        text-align: right;
        cursor: pointer;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        transition: all 0.2s ease;
      }

      .expense-amount:hover {
        background: rgba(16, 185, 129, 0.1);
      }

      .expense-actions {
        display: flex;
        gap: 0.5rem;
      }

      .expense-btn {
        padding: 0.25rem 0.5rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .expense-btn:hover {
        border-color: #cbd5e1;
        color: #1e293b;
      }

      .expense-btn.delete:hover {
        border-color: #ef4444;
        color: #ef4444;
        background: #fef2f2;
      }

      /* Modal for adding items */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .modal.show {
        display: flex;
      }

      .modal-content {
        background: white;
        padding: 2rem;
        border-radius: 16px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      .modal-header {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .modal-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .modal-section {
        margin-bottom: 1rem;
      }

      .modal-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.5rem;
        display: block;
      }

      .modal-input {
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        width: 100%;
      }

      .modal-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .amount-type-selector {
        display: flex;
        background: #f1f5f9;
        border-radius: 8px;
        padding: 0.25rem;
        margin-bottom: 0.75rem;
      }

      .amount-type-option {
        flex: 1;
        padding: 0.5rem 1rem;
        background: transparent;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.875rem;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .amount-type-option.active {
        background: white;
        color: #1e293b;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .amount-inputs-modal {
        display: flex;
        gap: 0.75rem;
        align-items: center;
      }

      .amount-input-modal {
        flex: 1;
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        text-align: center;
        transition: all 0.2s ease;
      }

      .amount-input-modal:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .frequency-select {
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        background: white;
        transition: all 0.2s ease;
        width: 100%;
      }

      .frequency-select:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .modal-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .modal-btn {
        flex: 1;
        padding: 0.75rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
      }

      .modal-btn.primary {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .modal-btn.primary:hover {
        background: #059669;
        transform: translateY(-1px);
      }

      .modal-btn.secondary {
        background: transparent;
        color: #64748b;
        border-color: #e2e8f0;
      }

      .modal-btn.secondary:hover {
        background: #f8fafc;
        color: #1e293b;
      }

      /* Hidden steps */
      .step {
        display: none;
      }

      .step.active {
        display: block;
        animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Responsive */
      @media (max-width: 1200px) {
        .form-grid {
          flex-direction: column;
          gap: 2rem;
        }

        .summary-panel {
          position: static;
          width: 100%;
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
          transition: transform 0.3s ease;
        }

        .main-content {
          margin-left: 0;
          width: 100vw;
          max-width: 100vw;
          padding: 1rem;
        }

        .step-title {
          font-size: 2rem;
        }

        .nav-buttons {
          flex-direction: column;
          align-items: center;
        }

        .btn {
          width: 200px;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="logo-area">
          <span class="logo-icon">💰</span>
          <div>
            <div class="logo-text">Budget Planner</div>
            <div class="breadcrumb">Create Budget</div>
          </div>
        </div>
        <div class="header-nav">
          <a href="#" class="nav-item active">Create Budget</a>
          <a href="#" class="nav-item">My Budget</a>
          <a href="#" class="nav-item">Goals</a>
          <a href="#" class="nav-item">Scenarios</a>
        </div>
      </header>

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-section">
          <div class="sidebar-title">Budget Creation</div>
          <div class="step-progress">
            <div class="step-item active" id="step1-indicator">
              <div class="step-number">1</div>
              <div class="step-details">
                <h4>Income</h4>
                <div class="step-description">Tell us what you earn</div>
              </div>
            </div>
            <div class="step-item" id="step2-indicator">
              <div class="step-number">2</div>
              <div class="step-details">
                <h4>Expenses</h4>
                <div class="step-description">How you spend it</div>
              </div>
            </div>
            <div class="step-item" id="step3-indicator">
              <div class="step-number">3</div>
              <div class="step-details">
                <h4>Goals</h4>
                <div class="step-description">What you want to achieve</div>
              </div>
            </div>
          </div>
        </div>

        <div class="sidebar-section">
          <div id="sidebar-content">
            <!-- Dynamic content based on current step -->
            <div class="running-total" id="income-total" style="display: none">
              <div class="total-title">Monthly Income</div>
              <div class="total-amount">£0</div>
              <div class="total-status">Add your income sources</div>
            </div>
          </div>
        </div>

        <div class="sidebar-section">
          <div class="tips-section">
            <div class="tips-title">Tips:</div>
            <div id="step-tips">
              <div class="tip">Use ranges if your income varies</div>
              <div class="tip">Include all regular income sources</div>
              <div class="tip">Don't worry about being exact</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Step 1: Income -->
        <div class="step active" id="step1">
          <div class="step-container">
            <div class="step-header">
              <h1 class="step-title">Tell us about your income</h1>
              <p class="step-subtitle">
                Let's start with how much money comes in each month
              </p>
            </div>

            <div class="form-grid">
              <div class="form-content">
                <!-- Primary Income -->
                <div class="income-source primary">
                  <div class="source-header">
                    <div class="source-title">
                      💼 Your Main Income
                      <span class="source-badge">PRIMARY</span>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Type of income:</label>
                    <div class="type-selector">
                      <button class="type-option active">Employment</button>
                      <button class="type-option">Self-Employed</button>
                      <button class="type-option">Benefits</button>
                      <button class="type-option">Other</button>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Monthly amount (after tax)</label>
                    <div class="amount-section">
                      <div class="amount-type-toggle">
                        <button
                          class="amount-type-btn active"
                          onclick="toggleAmountType(this, 'single')"
                        >
                          Exact Amount
                        </button>
                        <button
                          class="amount-type-btn"
                          onclick="toggleAmountType(this, 'range')"
                        >
                          Range
                        </button>
                      </div>
                      <div class="amount-inputs" id="amount-inputs">
                        <input
                          type="text"
                          class="amount-input"
                          placeholder="£2,500"
                          id="single-amount"
                          oninput="updateIncome()"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Secondary Income -->
                <div
                  class="income-source"
                  id="secondary-income"
                  style="display: none"
                >
                  <div class="source-header">
                    <div class="source-title">
                      💡 Additional Income
                      <span class="source-badge secondary">SECONDARY</span>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Type of income:</label>
                    <div class="type-selector">
                      <button class="type-option">Part-time Job</button>
                      <button class="type-option active">Freelance</button>
                      <button class="type-option">Side Business</button>
                      <button class="type-option">Other</button>
                    </div>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Monthly amount (after tax)</label>
                    <div class="amount-section">
                      <div class="amount-type-toggle">
                        <button class="amount-type-btn">Exact Amount</button>
                        <button class="amount-type-btn active">Range</button>
                      </div>
                      <div class="amount-inputs">
                        <input
                          type="text"
                          class="amount-input"
                          placeholder="£200"
                          oninput="updateIncome()"
                        />
                        <span class="range-separator">to</span>
                        <input
                          type="text"
                          class="amount-input"
                          placeholder="£600"
                          oninput="updateIncome()"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <button
                  class="add-source-btn"
                  onclick="showSecondaryIncome()"
                  id="add-income-btn"
                >
                  + Add Another Income Source
                </button>
              </div>

              <div class="summary-panel">
                <div class="summary-title">Your Monthly Income</div>
                <div class="summary-amount">
                  <div class="amount-display" id="income-display">£0</div>
                  <div class="amount-frequency">per month</div>
                </div>

                <div class="confidence-indicator">
                  <div class="confidence-header">
                    Income Confidence:
                    <span id="confidence-level">GETTING STARTED</span>
                  </div>
                  <div class="confidence-bar">
                    <div
                      class="confidence-fill"
                      id="confidence-fill"
                      style="width: 0%"
                    ></div>
                  </div>
                  <div class="confidence-text" id="confidence-text">
                    Add your income to see confidence level
                  </div>
                </div>

                <div
                  class="validation-message"
                  id="validation-message"
                  style="display: none"
                >
                  <div class="validation-text">
                    ✓ Great! You have a solid income foundation for budgeting
                  </div>
                </div>

                <button
                  class="btn btn-primary"
                  onclick="nextStep()"
                  id="continue-btn"
                  disabled
                >
                  CONTINUE TO EXPENSES →
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 2: Expenses -->
        <div class="step" id="step2">
          <div class="step-container">
            <div class="step-header">
              <h1 class="step-title">How do you spend your money?</h1>
              <p class="step-subtitle">
                Add your expenses to each category - start with the essentials
              </p>
            </div>

            <div class="form-grid">
              <div class="form-content">
                <!-- Essentials Category -->
                <div class="category-section essential">
                  <div class="category-header essential">
                    <div class="category-info">
                      <span class="category-icon">🏠</span>
                      <div class="category-details">
                        <h3>ESSENTIALS</h3>
                        <div class="category-description">
                          Rent, utilities, insurance, minimum debt payments
                        </div>
                      </div>
                    </div>
                    <div style="display: flex; align-items: center">
                      <div class="priority-badge">PRIORITY</div>
                      <div class="category-total" id="essentials-total">
                        £0/month
                      </div>
                    </div>
                  </div>
                  <div class="category-content">
                    <div
                      class="expense-placeholder"
                      id="essentials-placeholder"
                    >
                      No expenses added yet. These are your most important
                      costs.
                    </div>
                    <div
                      class="expense-list"
                      id="essentials-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('essentials')"
                    >
                      + Add Essential Expense
                    </button>
                  </div>
                </div>

                <!-- Basics Category -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">🛒</span>
                      <div class="category-details">
                        <h3>BASICS</h3>
                        <div class="category-description">
                          Food, transport, essential clothing
                        </div>
                      </div>
                    </div>
                    <div class="category-total" id="basics-total">£0/month</div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder" id="basics-placeholder">
                      Add your basic living expenses here.
                    </div>
                    <div
                      class="expense-list"
                      id="basics-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('basics')"
                    >
                      + Add Basic Expense
                    </button>
                  </div>
                </div>

                <!-- Wants Category -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">🎯</span>
                      <div class="category-details">
                        <h3>WANTS</h3>
                        <div class="category-description">
                          Entertainment, dining out, hobbies
                        </div>
                      </div>
                    </div>
                    <div class="category-total" id="wants-total">£0/month</div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder" id="wants-placeholder">
                      Add your discretionary spending here.
                    </div>
                    <div
                      class="expense-list"
                      id="wants-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('wants')"
                    >
                      + Add Want/Entertainment
                    </button>
                  </div>
                </div>

                <!-- Virtual Fund -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">⚡</span>
                      <div class="category-details">
                        <h3>VIRTUAL FUND</h3>
                        <div class="category-description">
                          Unexpected expenses safety net
                        </div>
                      </div>
                    </div>
                    <div class="category-total" id="virtual-total">
                      £0/month
                    </div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder" id="virtual-placeholder">
                      This fund covers unexpected costs like car repairs or
                      medical bills.
                    </div>
                    <div
                      class="expense-list"
                      id="virtual-list"
                      style="display: none"
                    ></div>
                    <button
                      class="add-expense-btn"
                      onclick="addExpense('virtual')"
                    >
                      + Add Virtual Fund Item
                    </button>
                  </div>
                </div>
              </div>

              <div class="summary-panel">
                <div class="summary-title">Budget Progress</div>
                <div class="summary-amount">
                  <div class="amount-display" id="expense-display">
                    £0 of £0
                  </div>
                  <div class="amount-frequency">allocated</div>
                </div>

                <div class="allocation-progress">
                  <div class="progress-header">Allocation Progress</div>
                  <div class="progress-bar">
                    <div
                      class="progress-fill"
                      id="allocation-fill"
                      style="width: 0%"
                    ></div>
                  </div>
                  <div class="progress-text" id="allocation-text">
                    Start adding expenses
                  </div>
                </div>

                <div class="confidence-indicator">
                  <div class="confidence-header">
                    Remaining:
                    <span
                      style="color: #10b981; font-weight: 700"
                      id="remaining-amount"
                      >£0</span
                    >
                  </div>
                  <div class="confidence-text" id="step2-confidence-text">
                    Aim to leave 20% for goals (recommended)
                  </div>
                </div>

                <div
                  class="validation-message"
                  id="step2-validation"
                  style="display: none"
                >
                  <div class="validation-text">
                    ✓ Great! You have money left for goals
                  </div>
                </div>

                <button
                  class="btn btn-primary"
                  onclick="nextStep()"
                  id="step2-continue-btn"
                  disabled
                >
                  SET YOUR GOALS →
                </button>
              </div>
            </div>

            <div class="nav-buttons">
              <button class="btn btn-secondary" onclick="prevStep()">
                ← BACK TO INCOME
              </button>
            </div>
          </div>
        </div>

        <!-- Step 3: Goals -->
        <div class="step" id="step3">
          <div class="step-container">
            <div class="step-header">
              <h1 class="step-title">What are your goals?</h1>
              <p class="step-subtitle">
                Let's put your monthly surplus to work for your future
              </p>
            </div>

            <div class="form-grid">
              <div class="form-content">
                <!-- Goals sections would go here -->
                <div class="category-section">
                  <div class="category-header">
                    <div class="category-info">
                      <span class="category-icon">🎯</span>
                      <div class="category-details">
                        <h3>GOALS</h3>
                        <div class="category-description">
                          What you want to achieve
                        </div>
                      </div>
                    </div>
                    <div class="category-total">£0/month</div>
                  </div>
                  <div class="category-content">
                    <div class="expense-placeholder">
                      Goals functionality coming soon...
                    </div>
                  </div>
                </div>
              </div>

              <div class="summary-panel">
                <div class="summary-title">Goal Summary</div>
                <div class="summary-amount">
                  <div class="amount-display">£0</div>
                  <div class="amount-frequency">allocated to goals</div>
                </div>

                <div class="confidence-indicator">
                  <div class="confidence-header">
                    Available:
                    <span style="color: #10b981; font-weight: 700">£0</span>
                  </div>
                  <div class="confidence-text">
                    Start adding goals to see your progress
                  </div>
                </div>

                <button class="btn btn-primary" onclick="completeBudget()">
                  CREATE MY BUDGET
                </button>
              </div>
            </div>

            <div class="nav-buttons">
              <button class="btn btn-secondary" onclick="prevStep()">
                ← BACK TO EXPENSES
              </button>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Modal for adding expenses -->
    <div class="modal" id="addModal">
      <div class="modal-content">
        <div class="modal-header" id="modalTitle">Add Expense</div>
        <div class="modal-form">
          <div class="modal-section">
            <label class="modal-label">Expense Name</label>
            <input
              type="text"
              class="modal-input"
              id="itemName"
              placeholder="e.g., Rent, Groceries"
            />
          </div>

          <div class="modal-section">
            <label class="modal-label">Amount Type</label>
            <div class="amount-type-selector">
              <button
                class="amount-type-option active"
                onclick="toggleModalAmountType(this, 'exact')"
              >
                Exact Amount
              </button>
              <button
                class="amount-type-option"
                onclick="toggleModalAmountType(this, 'range')"
              >
                Range
              </button>
            </div>
            <div class="amount-inputs-modal" id="modal-amount-inputs">
              <input
                type="text"
                class="amount-input-modal"
                id="itemAmount"
                placeholder="£150"
              />
            </div>
          </div>

          <div class="modal-section">
            <label class="modal-label">Frequency</label>
            <select class="frequency-select" id="itemFrequency">
              <option value="monthly">Monthly</option>
              <option value="weekly">Weekly</option>
              <option value="fortnightly">Fortnightly</option>
              <option value="quarterly">Quarterly</option>
              <option value="annually">Annually</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button class="modal-btn secondary" onclick="closeModal()">
            Cancel
          </button>
          <button class="modal-btn primary" onclick="saveItem()">
            Add Expense
          </button>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 1;
      let totalIncome = 0;
      let totalExpenses = 0;
      let totalGoals = 0;
      let currentCategory = '';
      let currentEditingId = null;
      let expenses = {
        essentials: [],
        basics: [],
        wants: [],
        virtual: []
      };

      function toggleAmountType(button, type) {
        // Remove active class from siblings
        button.parentElement
          .querySelectorAll('.amount-type-btn')
          .forEach((btn) => {
            btn.classList.remove('active');
          });
        button.classList.add('active');

        // Update input fields
        const container = document.getElementById('amount-inputs');
        if (type === 'range') {
          container.innerHTML = `
            <input type="text" class="amount-input" placeholder="£200" oninput="updateIncome()">
            <span class="range-separator">to</span>
            <input type="text" class="amount-input" placeholder="£600" oninput="updateIncome()">
          `;
        } else {
          container.innerHTML = `
            <input type="text" class="amount-input" placeholder="£2,500" id="single-amount" oninput="updateIncome()">
          `;
        }
      }

      function toggleModalAmountType(button, type) {
        // Remove active class from siblings
        button.parentElement
          .querySelectorAll('.amount-type-option')
          .forEach((btn) => {
            btn.classList.remove('active');
          });
        button.classList.add('active');

        // Update input fields in modal
        const container = document.getElementById('modal-amount-inputs');
        if (type === 'range') {
          container.innerHTML = `
            <input type="text" class="amount-input-modal" placeholder="£100" id="itemAmountMin">
            <span style="font-weight: 600; color: #64748b;">to</span>
            <input type="text" class="amount-input-modal" placeholder="£200" id="itemAmountMax">
          `;
        } else {
          container.innerHTML = `
            <input type="text" class="amount-input-modal" placeholder="£150" id="itemAmount">
          `;
        }
      }

      function showSecondaryIncome() {
        document.getElementById('secondary-income').style.display = 'block';
        document.getElementById('add-income-btn').style.display = 'none';
      }

      function updateIncome() {
        const inputs = document.querySelectorAll('#step1 .amount-input');
        let total = 0;
        let hasValue = false;

        inputs.forEach((input) => {
          const value = parseFloat(input.value.replace(/[£,]/g, '')) || 0;
          if (value > 0) {
            hasValue = true;
            total += value;
          }
        });

        totalIncome = total;

        // Update display
        const display = document.getElementById('income-display');
        const continueBtn = document.getElementById('continue-btn');
        const validation = document.getElementById('validation-message');
        const confidence = document.getElementById('confidence-level');
        const confidenceFill = document.getElementById('confidence-fill');
        const confidenceText = document.getElementById('confidence-text');

        if (hasValue) {
          display.textContent = `£${total.toLocaleString()}`;
          continueBtn.disabled = false;
          validation.style.display = 'block';

          if (total >= 1000) {
            confidence.textContent = 'EXCELLENT';
            confidenceFill.style.width = '90%';
            confidenceText.textContent =
              'Strong and reliable income foundation';
          } else if (total >= 500) {
            confidence.textContent = 'GOOD';
            confidenceFill.style.width = '70%';
            confidenceText.textContent = 'Solid income for basic budgeting';
          } else {
            confidence.textContent = 'GETTING STARTED';
            confidenceFill.style.width = '40%';
            confidenceText.textContent =
              'Every income level can benefit from budgeting';
          }
        } else {
          display.textContent = '£0';
          continueBtn.disabled = true;
          validation.style.display = 'none';
          confidence.textContent = 'GETTING STARTED';
          confidenceFill.style.width = '0%';
          confidenceText.textContent =
            'Add your income to see confidence level';
        }

        updateSidebarTotal();
      }

      function addExpense(category) {
        currentCategory = category;
        currentEditingId = null;

        const modal = document.getElementById('addModal');
        const title = document.getElementById('modalTitle');
        const nameInput = document.getElementById('itemName');

        // Reset modal
        title.textContent = `Add ${category.charAt(0).toUpperCase() + category.slice(1)} Expense`;
        nameInput.value = '';

        // Reset amount type to exact
        const exactBtn = document.querySelector('.amount-type-option');
        toggleModalAmountType(exactBtn, 'exact');

        // Reset frequency
        document.getElementById('itemFrequency').value = 'monthly';

        modal.classList.add('show');
        nameInput.focus();
      }

      function editExpense(category, id) {
        const item = expenses[category].find((exp) => exp.id === id);
        if (!item) return;

        currentCategory = category;
        currentEditingId = id;

        const modal = document.getElementById('addModal');
        const title = document.getElementById('modalTitle');
        const nameInput = document.getElementById('itemName');

        title.textContent = `Edit ${item.name}`;
        nameInput.value = item.name;

        // Set amount type
        const isRange = item.amountType === 'range';
        const amountBtn = isRange
          ? document.querySelectorAll('.amount-type-option')[1]
          : document.querySelectorAll('.amount-type-option')[0];

        toggleModalAmountType(amountBtn, isRange ? 'range' : 'exact');

        // Set amount values
        setTimeout(() => {
          if (isRange) {
            document.getElementById('itemAmountMin').value =
              item.amountMin || '';
            document.getElementById('itemAmountMax').value =
              item.amountMax || '';
          } else {
            document.getElementById('itemAmount').value = item.amount || '';
          }
        }, 10);

        // Set frequency
        document.getElementById('itemFrequency').value =
          item.frequency || 'monthly';

        modal.classList.add('show');
        nameInput.focus();
      }

      function closeModal() {
        document.getElementById('addModal').classList.remove('show');
        currentEditingId = null;
      }

      function saveItem() {
        const nameInput = document.getElementById('itemName');
        const frequencySelect = document.getElementById('itemFrequency');
        const name = nameInput.value.trim();
        const frequency = frequencySelect.value;

        if (!name) {
          alert('Please enter an expense name');
          return;
        }

        // Determine if it's exact or range
        const isRange = document
          .querySelector('.amount-type-option.active')
          .textContent.includes('Range');

        let amount = 0;
        let amountDisplay = '';
        let item = {
          id: currentEditingId || Date.now(),
          name: name,
          frequency: frequency,
          amountType: isRange ? 'range' : 'exact'
        };

        if (isRange) {
          const minInput = document.getElementById('itemAmountMin');
          const maxInput = document.getElementById('itemAmountMax');
          const minAmount =
            parseFloat(minInput.value.replace(/[£,]/g, '')) || 0;
          const maxAmount =
            parseFloat(maxInput.value.replace(/[£,]/g, '')) || 0;

          if (minAmount <= 0 || maxAmount <= 0 || minAmount >= maxAmount) {
            alert('Please enter valid range amounts (min < max)');
            return;
          }

          item.amountMin = minAmount;
          item.amountMax = maxAmount;
          amount = (minAmount + maxAmount) / 2; // Use average for calculations
          amountDisplay = `£${minAmount.toLocaleString()}-£${maxAmount.toLocaleString()}`;
        } else {
          const amountInput = document.getElementById('itemAmount');
          const singleAmount =
            parseFloat(amountInput.value.replace(/[£,]/g, '')) || 0;

          if (singleAmount <= 0) {
            alert('Please enter a valid amount');
            return;
          }

          item.amount = singleAmount;
          amount = singleAmount;
          amountDisplay = `£${singleAmount.toLocaleString()}`;
        }

        // Convert to monthly if needed
        const monthlyAmount = convertToMonthly(amount, frequency);
        item.monthlyAmount = monthlyAmount;

        // Add frequency indicator to display if not monthly
        if (frequency !== 'monthly') {
          amountDisplay += `/${frequency}`;
        }
        item.amountDisplay = amountDisplay;

        // Add or update item
        if (currentEditingId) {
          // Update existing
          const index = expenses[currentCategory].findIndex(
            (exp) => exp.id === currentEditingId
          );
          if (index !== -1) {
            expenses[currentCategory][index] = item;
          }
        } else {
          // Add new
          expenses[currentCategory].push(item);
        }

        updateExpenseDisplay(currentCategory);
        updateExpenseTotals();
        closeModal();
        updateSidebarTotal();
        updateContinueButton();
      }

      function convertToMonthly(amount, frequency) {
        const multipliers = {
          monthly: 1,
          weekly: 4.33,
          fortnightly: 2.17,
          quarterly: 1 / 3,
          annually: 1 / 12
        };
        return amount * (multipliers[frequency] || 1);
      }

      function updateExpenseDisplay(category) {
        const list = document.getElementById(`${category}-list`);
        const placeholder = document.getElementById(`${category}-placeholder`);
        const items = expenses[category];

        if (items.length > 0) {
          placeholder.style.display = 'none';
          list.style.display = 'block';

          list.innerHTML = items
            .map(
              (item) => `
              <div class="expense-item">
                <div class="expense-name">${item.name}</div>
                <div class="expense-amount" onclick="editExpense('${category}', ${item.id})">
                  ${item.amountDisplay}
                </div>
                <div class="expense-actions">
                  <button class="expense-btn" onclick="editExpense('${category}', ${item.id})">Edit</button>
                  <button class="expense-btn delete" onclick="removeExpense('${category}', ${item.id})">Delete</button>
                </div>
              </div>
            `
            )
            .join('');
        } else {
          placeholder.style.display = 'block';
          list.style.display = 'none';
        }
      }

      function removeExpense(category, id) {
        expenses[category] = expenses[category].filter((exp) => exp.id !== id);
        updateExpenseDisplay(category);
        updateExpenseTotals();
        updateSidebarTotal();
        updateContinueButton();
      }

      function updateExpenseTotals() {
        // Calculate totals for each category
        let grandTotal = 0;

        Object.keys(expenses).forEach((category) => {
          const total = expenses[category].reduce(
            (sum, item) => sum + item.monthlyAmount,
            0
          );
          grandTotal += total;

          // Update category total display
          document.getElementById(`${category}-total`).textContent =
            `£${total.toLocaleString()}/month`;
        });

        totalExpenses = grandTotal;

        // Update step 2 summary
        if (currentStep === 2) {
          const remaining = totalIncome - totalExpenses;
          const recommendedGoalAmount = totalIncome * 0.2; // 20% for goals
          const allocationPercentage =
            totalIncome > 0 ? (totalExpenses / totalIncome) * 100 : 0;

          document.getElementById('expense-display').textContent =
            `£${totalExpenses.toLocaleString()} of £${totalIncome.toLocaleString()}`;

          document.getElementById('remaining-amount').textContent =
            `£${remaining.toLocaleString()}`;

          // Update allocation progress
          const progressFill = document.getElementById('allocation-fill');
          const progressText = document.getElementById('allocation-text');

          if (totalIncome > 0) {
            progressFill.style.width = `${Math.min(allocationPercentage, 100)}%`;

            if (remaining >= recommendedGoalAmount) {
              progressText.textContent = `${allocationPercentage.toFixed(0)}% allocated - excellent room for goals`;
            } else if (remaining > 0) {
              progressText.textContent = `${allocationPercentage.toFixed(0)}% allocated - some room for goals`;
            } else {
              progressText.textContent = `${allocationPercentage.toFixed(0)}% allocated - over budget`;
            }
          } else {
            progressFill.style.width = '0%';
            progressText.textContent = 'Start adding expenses';
          }

          // Update confidence text
          const confidenceText = document.getElementById(
            'step2-confidence-text'
          );
          if (remaining >= recommendedGoalAmount) {
            confidenceText.textContent =
              'Perfect! You have excellent room for goals';
          } else if (remaining > 0) {
            confidenceText.textContent = `Try to leave £${recommendedGoalAmount.toLocaleString()} (20%) for goals`;
          } else {
            confidenceText.textContent =
              "You're over budget - try reducing some expenses";
          }
        }
      }

      function updateContinueButton() {
        if (currentStep === 2) {
          const hasExpenses = Object.values(expenses).some(
            (category) => category.length > 0
          );
          const remaining = totalIncome - totalExpenses;
          const continueBtn = document.getElementById('step2-continue-btn');
          const validation = document.getElementById('step2-validation');

          continueBtn.disabled = !hasExpenses || remaining < 0;

          if (hasExpenses && remaining >= 0) {
            validation.style.display = 'block';
          } else {
            validation.style.display = 'none';
          }
        }
      }

      function updateSidebarTotal() {
        const incomeTotal = document.getElementById('income-total');

        // Hide all totals first
        incomeTotal.style.display = 'none';

        if (currentStep === 1) {
          incomeTotal.style.display = 'block';
          incomeTotal.querySelector('.total-amount').textContent =
            `£${totalIncome.toLocaleString()}`;
          if (totalIncome > 0) {
            incomeTotal.querySelector('.total-status').textContent =
              'Ready for next step';
          }
        }
      }

      function updateStepIndicators() {
        const indicators = [
          'step1-indicator',
          'step2-indicator',
          'step3-indicator'
        ];

        indicators.forEach((id, index) => {
          const indicator = document.getElementById(id);
          const stepNum = index + 1;

          indicator.classList.remove('active', 'completed');

          if (stepNum < currentStep) {
            indicator.classList.add('completed');
            indicator.querySelector('.step-number').textContent = '✓';
          } else if (stepNum === currentStep) {
            indicator.classList.add('active');
            indicator.querySelector('.step-number').textContent = stepNum;
          } else {
            indicator.querySelector('.step-number').textContent = stepNum;
          }
        });
      }

      function updateTips() {
        const tipsContainer = document.getElementById('step-tips');
        const tips = {
          1: [
            'Use ranges if your income varies',
            'Include all regular income sources',
            "Don't worry about being exact"
          ],
          2: [
            'Start with essentials first',
            'Click amounts to edit them inline',
            'Use ranges for variable costs',
            'Include annual costs with frequency'
          ],
          3: [
            'Start with what feels most important',
            'Every step forward is progress',
            'Drag to reorder by priority'
          ]
        };

        tipsContainer.innerHTML = tips[currentStep]
          .map((tip) => `<div class="tip">${tip}</div>`)
          .join('');
      }

      function nextStep() {
        if (currentStep < 3) {
          // Hide current step
          document
            .getElementById(`step${currentStep}`)
            .classList.remove('active');

          currentStep++;

          // Show next step
          document.getElementById(`step${currentStep}`).classList.add('active');

          updateStepIndicators();
          updateSidebarTotal();
          updateTips();
          updateContinueButton();
        }
      }

      function prevStep() {
        if (currentStep > 1) {
          // Hide current step
          document
            .getElementById(`step${currentStep}`)
            .classList.remove('active');

          currentStep--;

          // Show previous step
          document.getElementById(`step${currentStep}`).classList.add('active');

          updateStepIndicators();
          updateSidebarTotal();
          updateTips();
          updateContinueButton();
        }
      }

      function completeBudget() {
        alert(
          "🎉 Congratulations! Your budget has been created successfully.\n\nYou'll now be taken to your dashboard where you can see how your finances are working for you."
        );
      }

      // Close modal when clicking outside
      document
        .getElementById('addModal')
        .addEventListener('click', function (e) {
          if (e.target === this) {
            closeModal();
          }
        });

      // Handle Enter key in modal
      document.addEventListener('keydown', function (e) {
        if (
          e.key === 'Enter' &&
          document.getElementById('addModal').classList.contains('show')
        ) {
          saveItem();
        } else if (e.key === 'Escape') {
          closeModal();
        }
      });

      // Initialize
      updateStepIndicators();
      updateSidebarTotal();
      updateTips();
    </script>
  </body>
</html>
