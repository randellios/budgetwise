<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Budget Planner - How do you spend your money?</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          Roboto,
          sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        color: #1e293b;
        line-height: 1.6;
        overflow-x: hidden;
      }

      .app-container {
        display: flex;
        min-height: 100vh;
      }

      /* Header */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 70px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 2rem;
        z-index: 100;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }

      .logo-area {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .logo-icon {
        font-size: 1.75rem;
      }

      .logo-text {
        font-size: 1.25rem;
        font-weight: 700;
        color: #1e293b;
      }

      .breadcrumb {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .header-nav {
        display: flex;
        gap: 1rem;
      }

      .nav-item {
        padding: 0.5rem 1rem;
        border-radius: 6px;
        font-weight: 500;
        color: #64748b;
        text-decoration: none;
        transition: all 0.2s ease;
      }

      .nav-item.active {
        background: #1e293b;
        color: white;
      }

      .nav-item:hover:not(.active) {
        background: rgba(241, 245, 249, 0.8);
        color: #1e293b;
      }

      /* Sidebar */
      .sidebar {
        width: 320px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-right: 1px solid rgba(226, 232, 240, 0.8);
        position: fixed;
        left: 0;
        top: 70px;
        bottom: 0;
        overflow-y: auto;
        z-index: 50;
        display: flex;
        flex-direction: column;
      }

      .sidebar-section {
        padding: 1.5rem;
        border-bottom: 1px solid rgba(226, 232, 240, 0.5);
      }

      .sidebar-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-bottom: 1rem;
      }

      /* Step Progress */
      .step-progress {
        margin-bottom: 1.5rem;
      }

      .step-item {
        display: flex;
        align-items: center;
        margin-bottom: 1rem;
        padding: 0.75rem;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .step-item.active {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .step-item.completed {
        background: rgba(16, 185, 129, 0.1);
        color: #059669;
      }

      .step-number {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-weight: 700;
        font-size: 0.875rem;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
      }

      .step-item.active .step-number {
        background: rgba(255, 255, 255, 0.9);
        color: #059669;
        border-color: rgba(255, 255, 255, 0.9);
      }

      .step-item.completed .step-number {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .step-details h4 {
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .step-description {
        font-size: 0.75rem;
        opacity: 0.8;
      }

      /* Running Total */
      .running-total {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .total-title {
        font-size: 0.875rem;
        opacity: 0.9;
        margin-bottom: 0.5rem;
      }

      .total-amount {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .total-status {
        font-size: 0.75rem;
        opacity: 0.9;
      }

      /* Tips */
      .tips-section {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(10px);
        padding: 1rem;
        border-radius: 8px;
        border: 1px solid rgba(226, 232, 240, 0.8);
      }

      .tips-title {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.75rem;
      }

      .tip {
        font-size: 0.75rem;
        color: #64748b;
        margin-bottom: 0.5rem;
        padding-left: 1rem;
        position: relative;
      }

      .tip:before {
        content: '💡';
        position: absolute;
        left: 0;
        top: 0;
      }

      /* Main Content */
      .main-content {
        margin-left: 320px;
        margin-top: 70px;
        padding: 2rem;
        min-height: calc(100vh - 70px);
        max-width: calc(100vw - 320px);
        width: calc(100vw - 320px);
      }

      /* Step Container */
      .step-container {
        max-width: 1152px;
        margin: 0 auto;
      }

      .step-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .step-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 0.75rem;
      }

      .step-subtitle {
        font-size: 1.125rem;
        color: #64748b;
        max-width: 600px;
        margin: 0 auto;
      }

      /* Form Styles */
      .form-grid {
        display: flex;
        gap: 3rem;
        margin-bottom: 3rem;
        align-items: flex-start;
      }

      .form-content {
        display: flex;
        flex-direction: column;
        gap: 2rem;
        flex: 1;
      }

      .category-section {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .category-section:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
      }

      .category-section.essential {
        border-color: #ef4444;
        box-shadow: 0 8px 32px rgba(239, 68, 68, 0.15);
      }

      .category-header {
        padding: 1.5rem 2rem;
        background: #f8fafc;
        border-bottom: 1px solid #e2e8f0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .category-header.essential {
        background: #fef2f2;
        border-bottom-color: #fecaca;
      }

      .category-info {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .category-icon {
        font-size: 1.5rem;
      }

      .category-details h3 {
        font-size: 1.125rem;
        font-weight: 600;
        color: #1e293b;
        margin: 0;
      }

      .category-description {
        font-size: 0.875rem;
        color: #64748b;
        margin-top: 0.25rem;
      }

      .priority-badge {
        background: #ef4444;
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        margin-right: 1rem;
      }

      .category-total {
        font-size: 1.125rem;
        font-weight: 700;
        color: #10b981;
      }

      .category-content {
        padding: 2rem;
      }

      .expense-placeholder {
        text-align: center;
        padding: 3rem 2rem;
        color: #64748b;
        font-style: italic;
      }

      .add-expense-btn {
        background: #f8fafc;
        border: 2px dashed #e2e8f0;
        padding: 1rem 2rem;
        border-radius: 8px;
        color: #64748b;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        width: 100%;
      }

      .add-expense-btn:hover {
        border-color: #10b981;
        color: #10b981;
        background: #f0fdf4;
      }

      /* Expense Items */
      .expense-item {
        display: flex;
        align-items: center;
        padding: 1rem;
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        margin-bottom: 0.75rem;
        transition: all 0.2s ease;
      }

      .expense-item:hover {
        background: #f1f5f9;
        border-color: #cbd5e1;
      }

      .expense-name {
        flex: 1;
        font-weight: 500;
        color: #1e293b;
        margin-right: 1rem;
      }

      .expense-amount {
        font-weight: 600;
        color: #10b981;
        margin-right: 1rem;
        min-width: 120px;
        text-align: right;
        cursor: pointer;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        transition: all 0.2s ease;
      }

      .expense-amount:hover {
        background: rgba(16, 185, 129, 0.1);
      }

      .expense-actions {
        display: flex;
        gap: 0.5rem;
      }

      .expense-btn {
        padding: 0.25rem 0.5rem;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
        font-size: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .expense-btn:hover {
        border-color: #cbd5e1;
        color: #1e293b;
      }

      .expense-btn.delete:hover {
        border-color: #ef4444;
        color: #ef4444;
        background: #fef2f2;
      }

      /* Summary Panel */
      .summary-panel {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        padding: 2rem;
        border-radius: 16px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        height: fit-content;
        position: sticky;
        top: 2rem;
        width: 400px;
        flex-shrink: 0;
      }

      .summary-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .summary-amount {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 2rem;
        border-radius: 12px;
        text-align: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      }

      .amount-display {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .amount-frequency {
        font-size: 0.875rem;
        opacity: 0.9;
      }

      /* Clean Summary Header */
      .summary-header {
        margin-bottom: 1.5rem;
      }

      .budget-overview {
        background: rgba(248, 250, 252, 0.8);
        border: 1px solid #e2e8f0;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        text-align: center;
        display: flex;
        align-items: baseline;
        justify-content: center;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .allocated-text {
        font-size: 1.25rem;
        font-weight: 600;
        color: #059669;
      }

      .of-text {
        font-size: 0.875rem;
        color: #64748b;
        font-weight: 400;
      }

      .total-text {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
      }

      .summary-label {
        font-size: 0.875rem;
        color: #64748b;
        font-weight: 500;
        margin-left: 0.25rem;
      }

      .allocation-progress {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .progress-header {
        font-size: 0.875rem;
        font-weight: 600;
        color: #166534;
        margin-bottom: 0.5rem;
      }

      .progress-bar {
        height: 8px;
        background: #dcfce7;
        border-radius: 4px;
        overflow: hidden;
        margin-bottom: 0.5rem;
      }

      .progress-fill {
        height: 100%;
        background: #16a34a;
        border-radius: 4px;
        transition: width 0.3s ease;
      }

      .progress-text {
        font-size: 0.75rem;
        color: #166534;
      }

      /* Clean Budget Progress */
      .budget-progress-section {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(226, 232, 240, 0.8);
        padding: 2rem;
        border-radius: 16px;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .progress-hero {
        margin-bottom: 1.5rem;
      }

      .circular-budget-progress {
        position: relative;
        width: 120px;
        height: 120px;
        margin: 0 auto;
      }

      .circular-track {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        background: conic-gradient(
          #10b981 0deg,
          #10b981 var(--fill-angle, 0deg),
          #f1f5f9 var(--fill-angle, 0deg),
          #f1f5f9 360deg
        );
        padding: 6px;
        position: relative;
        transition: all 0.4s ease;
      }

      .circular-track::before {
        content: '';
        position: absolute;
        top: 6px;
        left: 6px;
        width: 108px;
        height: 108px;
        background: white;
        border-radius: 50%;
      }

      .progress-center {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 2;
      }

      .progress-percentage {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 0.25rem;
        transition: all 0.3s ease;
      }

      .progress-label {
        font-size: 0.75rem;
        color: #64748b;
        font-weight: 500;
      }

      .budget-stats {
        display: flex;
        gap: 1.5rem;
        justify-content: center;
        margin-bottom: 1.5rem;
      }

      .stat-item {
        text-align: center;
        flex: 1;
        max-width: 160px;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        padding: 1.25rem 1rem;
        border-radius: 12px;
        border: 1px solid rgba(226, 232, 240, 0.8);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .stat-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        transition: left 0.5s ease;
      }

      .stat-item:hover::before {
        left: 100%;
      }

      .stat-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        border-color: #10b981;
      }

      .stat-label {
        font-size: 0.875rem;
        color: #64748b;
        margin-bottom: 0.75rem;
        font-weight: 600;
        position: relative;
        z-index: 1;
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1e293b;
        transition: all 0.3s ease;
        position: relative;
        z-index: 1;
      }

      .stat-value.remaining {
        color: #0369a1;
      }

      .stat-value.goals {
        color: #059669;
      }

      .stat-value.celebrating {
        animation: stat-celebration 0.6s ease-in-out;
      }

      .stat-value.pulsing {
        animation: gentle-pulse 2s ease-in-out infinite;
      }

      @keyframes stat-celebration {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      @keyframes gentle-pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
      }

      /* Special states for different budget health */
      .stat-item.excellent {
        background: linear-gradient(
          135deg,
          rgba(240, 253, 244, 0.9),
          rgba(220, 252, 231, 0.9)
        );
        border-color: #bbf7d0;
      }

      .stat-item.excellent .stat-value.goals {
        color: #059669;
        animation: gentle-pulse 2s ease-in-out infinite;
      }

      .stat-item.warning {
        background: linear-gradient(
          135deg,
          rgba(255, 251, 235, 0.9),
          rgba(254, 243, 199, 0.9)
        );
        border-color: #fde68a;
      }

      .stat-item.danger {
        background: linear-gradient(
          135deg,
          rgba(254, 242, 242, 0.9),
          rgba(254, 202, 202, 0.9)
        );
        border-color: #fca5a5;
      }

      .stat-item.danger .stat-value.remaining {
        color: #dc2626;
      }

      .progress-status {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        padding: 1rem;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        transition: all 0.3s ease;
      }

      .status-icon {
        font-size: 1.25rem;
        transition: all 0.3s ease;
      }

      .status-text {
        font-size: 0.875rem;
        color: #64748b;
        font-weight: 500;
        line-height: 1.4;
      }

      /* Progress states */
      .circular-track.excellent {
        background: conic-gradient(
          #10b981 0deg,
          #10b981 var(--fill-angle, 0deg),
          #f1f5f9 var(--fill-angle, 0deg),
          #f1f5f9 360deg
        );
        box-shadow: 0 0 16px rgba(16, 185, 129, 0.2);
      }

      .circular-track.good {
        background: conic-gradient(
          #059669 0deg,
          #059669 var(--fill-angle, 0deg),
          #f1f5f9 var(--fill-angle, 0deg),
          #f1f5f9 360deg
        );
      }

      .circular-track.warning {
        background: conic-gradient(
          #f59e0b 0deg,
          #f59e0b var(--fill-angle, 0deg),
          #f1f5f9 var(--fill-angle, 0deg),
          #f1f5f9 360deg
        );
      }

      .circular-track.danger {
        background: conic-gradient(
          #ef4444 0deg,
          #ef4444 var(--fill-angle, 0deg),
          #f1f5f9 var(--fill-angle, 0deg),
          #f1f5f9 360deg
        );
      }

      .progress-status.excellent {
        background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        border-color: #bbf7d0;
      }

      .progress-status.excellent .status-text {
        color: #166534;
      }

      .progress-status.warning {
        background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
        border-color: #fde68a;
      }

      .progress-status.warning .status-text {
        color: #92400e;
      }

      .progress-status.danger {
        background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
        border-color: #fca5a5;
      }

      .progress-status.danger .status-text {
        color: #991b1b;
      }

      .stat-value.celebrating {
        animation: stat-celebration 0.6s ease-in-out;
      }

      .stat-value.pulsing {
        animation: gentle-pulse 2s ease-in-out infinite;
      }

      @keyframes stat-celebration {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      @keyframes gentle-pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
      }

      .validation-message {
        background: #f0fdf4;
        border: 1px solid #bbf7d0;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
      }

      .validation-text {
        font-size: 0.875rem;
        color: #166534;
        font-weight: 500;
      }

      /* Navigation Buttons */
      .nav-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 3rem;
      }

      .btn {
        padding: 0.875rem 2rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .btn-primary:hover {
        background: #059669;
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
      }

      .btn-secondary {
        background: transparent;
        color: #64748b;
        border-color: #e2e8f0;
      }

      .btn-secondary:hover {
        background: #f8fafc;
        color: #1e293b;
        border-color: #cbd5e1;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none !important;
      }

      /* Modal for adding items */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .modal.show {
        display: flex;
      }

      .modal-content {
        background: white;
        padding: 2rem;
        border-radius: 16px;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      .modal-header {
        font-size: 1.25rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .modal-form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .modal-section {
        margin-bottom: 1rem;
      }

      .modal-label {
        font-size: 0.875rem;
        font-weight: 600;
        color: #1e293b;
        margin-bottom: 0.5rem;
        display: block;
      }

      .modal-input {
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        width: 100%;
      }

      .modal-input:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .amount-type-selector {
        display: flex;
        background: #f1f5f9;
        border-radius: 8px;
        padding: 0.25rem;
        margin-bottom: 0.75rem;
      }

      .amount-type-option {
        flex: 1;
        padding: 0.5rem 1rem;
        background: transparent;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        font-size: 0.875rem;
        transition: all 0.2s ease;
        color: #64748b;
      }

      .amount-type-option.active {
        background: white;
        color: #1e293b;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .amount-inputs-modal {
        display: flex;
        gap: 0.75rem;
        align-items: center;
      }

      .amount-input-modal {
        flex: 1;
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        text-align: center;
        transition: all 0.2s ease;
      }

      .amount-input-modal:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .frequency-select {
        padding: 0.75rem;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        font-size: 1rem;
        background: white;
        transition: all 0.2s ease;
        width: 100%;
      }

      .frequency-select:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
      }

      .modal-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .modal-btn {
        flex: 1;
        padding: 0.75rem;
        border-radius: 8px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
      }

      .modal-btn.primary {
        background: #10b981;
        color: white;
        border-color: #10b981;
      }

      .modal-btn.primary:hover {
        background: #059669;
        transform: translateY(-1px);
      }

      .modal-btn.secondary {
        background: transparent;
        color: #64748b;
        border-color: #e2e8f0;
      }

      .modal-btn.secondary:hover {
        background: #f8fafc;
        color: #1e293b;
      }

      /* Responsive */
      @media (max-width: 1200px) {
        .form-grid {
          flex-direction: column;
          gap: 2rem;
        }

        .summary-panel {
          position: static;
          width: 100%;
        }
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
          transition: transform 0.3s ease;
        }

        .main-content {
          margin-left: 0;
          width: 100vw;
          max-width: 100vw;
          padding: 1rem;
        }

        .step-title {
          font-size: 2rem;
        }

        .nav-buttons {
          flex-direction: column;
          align-items: center;
        }

        .btn {
          width: 200px;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <header class="header">
        <div class="logo-area">
          <span class="logo-icon">💰</span>
          <div>
            <div class="logo-text">Budget Planner</div>
            <div class="breadcrumb">Create Budget > Expenses</div>
          </div>
        </div>
        <div class="header-nav">
          <a href="#" class="nav-item active">Create Budget</a>
          <a href="#" class="nav-item">My Budget</a>
          <a href="#" class="nav-item">Goals</a>
          <a href="#" class="nav-item">Scenarios</a>
        </div>
      </header>

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-section">
          <div class="sidebar-title">Budget Creation</div>
          <div class="step-progress">
            <div class="step-item completed">
              <div class="step-number">✓</div>
              <div class="step-details">
                <h4>Income</h4>
                <div class="step-description">£2,900/month</div>
              </div>
            </div>
            <div class="step-item active">
              <div class="step-number">2</div>
              <div class="step-details">
                <h4>Expenses</h4>
                <div class="step-description">How you spend it</div>
              </div>
            </div>
            <div class="step-item">
              <div class="step-number">3</div>
              <div class="step-details">
                <h4>Goals</h4>
                <div class="step-description">What you want to achieve</div>
              </div>
            </div>
          </div>
        </div>

        <div class="sidebar-section">
          <div class="tips-section">
            <div class="tips-title">Tips:</div>
            <div class="tip">Start with essentials first</div>
            <div class="tip">Click amounts to edit them inline</div>
            <div class="tip">Use ranges for variable costs</div>
            <div class="tip">Include annual costs with frequency</div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <div class="step-container">
          <div class="step-header">
            <h1 class="step-title">How do you spend your money?</h1>
            <p class="step-subtitle">
              Add your expenses to each category - start with the essentials
            </p>
          </div>

          <div class="form-grid">
            <div class="form-content">
              <!-- Essentials Category -->
              <div class="category-section essential">
                <div class="category-header essential">
                  <div class="category-info">
                    <span class="category-icon">🏠</span>
                    <div class="category-details">
                      <h3>ESSENTIALS</h3>
                      <div class="category-description">
                        Rent, utilities, insurance, minimum debt payments
                      </div>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center">
                    <div class="priority-badge">PRIORITY</div>
                    <div class="category-total" id="essentials-total">
                      £0/month
                    </div>
                  </div>
                </div>
                <div class="category-content">
                  <div class="expense-placeholder" id="essentials-placeholder">
                    No expenses added yet. These are your most important costs.
                  </div>
                  <div
                    class="expense-list"
                    id="essentials-list"
                    style="display: none"
                  ></div>
                  <button
                    class="add-expense-btn"
                    onclick="addExpense('essentials')"
                  >
                    + Add Essential Expense
                  </button>
                </div>
              </div>

              <!-- Basics Category -->
              <div class="category-section">
                <div class="category-header">
                  <div class="category-info">
                    <span class="category-icon">🛒</span>
                    <div class="category-details">
                      <h3>BASICS</h3>
                      <div class="category-description">
                        Food, transport, essential clothing
                      </div>
                    </div>
                  </div>
                  <div class="category-total" id="basics-total">£0/month</div>
                </div>
                <div class="category-content">
                  <div class="expense-placeholder" id="basics-placeholder">
                    Add your basic living expenses here.
                  </div>
                  <div
                    class="expense-list"
                    id="basics-list"
                    style="display: none"
                  ></div>
                  <button
                    class="add-expense-btn"
                    onclick="addExpense('basics')"
                  >
                    + Add Basic Expense
                  </button>
                </div>
              </div>

              <!-- Wants Category -->
              <div class="category-section">
                <div class="category-header">
                  <div class="category-info">
                    <span class="category-icon">🎯</span>
                    <div class="category-details">
                      <h3>WANTS</h3>
                      <div class="category-description">
                        Entertainment, dining out, hobbies
                      </div>
                    </div>
                  </div>
                  <div class="category-total" id="wants-total">£0/month</div>
                </div>
                <div class="category-content">
                  <div class="expense-placeholder" id="wants-placeholder">
                    Add your discretionary spending here.
                  </div>
                  <div
                    class="expense-list"
                    id="wants-list"
                    style="display: none"
                  ></div>
                  <button class="add-expense-btn" onclick="addExpense('wants')">
                    + Add Want/Entertainment
                  </button>
                </div>
              </div>

              <!-- Virtual Fund -->
              <div class="category-section">
                <div class="category-header">
                  <div class="category-info">
                    <span class="category-icon">⚡</span>
                    <div class="category-details">
                      <h3>VIRTUAL FUND</h3>
                      <div class="category-description">
                        Unexpected expenses safety net
                      </div>
                    </div>
                  </div>
                  <div class="category-total" id="virtual-total">£0/month</div>
                </div>
                <div class="category-content">
                  <div class="expense-placeholder" id="virtual-placeholder">
                    This fund covers unexpected costs like car repairs or
                    medical bills.
                  </div>
                  <div
                    class="expense-list"
                    id="virtual-list"
                    style="display: none"
                  ></div>
                  <button
                    class="add-expense-btn"
                    onclick="addExpense('virtual')"
                  >
                    + Add Virtual Fund Item
                  </button>
                </div>
              </div>
            </div>

            <div class="summary-panel">
              <div class="summary-title">Budget Progress</div>
              <div class="summary-header">
                <div class="budget-overview">
                  <span class="allocated-text"
                    >£<span id="allocated-display">0</span></span
                  >
                  <span class="of-text">of</span>
                  <span class="total-text">£2,900</span>
                  <span class="summary-label">allocated</span>
                </div>
              </div>

              <div class="budget-progress-section">
                <div class="progress-hero">
                  <div class="circular-budget-progress">
                    <div class="circular-track">
                      <div class="circular-fill" id="circular-fill"></div>
                    </div>
                    <div class="progress-center">
                      <div class="progress-percentage" id="progress-percentage">
                        0%
                      </div>
                      <div class="progress-label">allocated</div>
                    </div>
                  </div>
                </div>

                <div class="budget-stats">
                  <div class="stat-item primary">
                    <div class="stat-label">💰 Remaining</div>
                    <div class="stat-value remaining" id="remaining-amount">
                      £2,900
                    </div>
                  </div>
                  <div class="stat-item secondary">
                    <div class="stat-label">🎯 Available for Goals</div>
                    <div class="stat-value goals" id="goals-available">
                      £2,900
                    </div>
                  </div>
                </div>

                <div class="progress-status" id="progress-status">
                  <div class="status-icon" id="status-icon">💡</div>
                  <div class="status-text" id="status-text">
                    Start adding expenses to see your progress
                  </div>
                </div>
              </div>

              <button
                class="btn btn-primary"
                onclick="continueToGoals()"
                id="step2-continue-btn"
                disabled
              >
                SET YOUR GOALS →
              </button>
            </div>
          </div>

          <div class="nav-buttons">
            <button class="btn btn-secondary" onclick="backToIncome()">
              ← BACK TO INCOME
            </button>
          </div>
        </div>
      </main>
    </div>

    <!-- Modal for adding expenses -->
    <div class="modal" id="addModal">
      <div class="modal-content">
        <div class="modal-header" id="modalTitle">Add Expense</div>
        <div class="modal-form">
          <div class="modal-section">
            <label class="modal-label">Expense Name</label>
            <input
              type="text"
              class="modal-input"
              id="itemName"
              placeholder="e.g., Rent, Groceries"
            />
          </div>

          <div class="modal-section">
            <label class="modal-label">Amount Type</label>
            <div class="amount-type-selector">
              <button
                class="amount-type-option active"
                onclick="toggleModalAmountType(this, 'exact')"
              >
                Exact Amount
              </button>
              <button
                class="amount-type-option"
                onclick="toggleModalAmountType(this, 'range')"
              >
                Range
              </button>
            </div>
            <div class="amount-inputs-modal" id="modal-amount-inputs">
              <input
                type="text"
                class="amount-input-modal"
                id="itemAmount"
                placeholder="£150"
              />
            </div>
          </div>

          <div class="modal-section">
            <label class="modal-label">Frequency</label>
            <select class="frequency-select" id="itemFrequency">
              <option value="monthly">Monthly</option>
              <option value="weekly">Weekly</option>
              <option value="fortnightly">Fortnightly</option>
              <option value="quarterly">Quarterly</option>
              <option value="annually">Annually</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button class="modal-btn secondary" onclick="closeModal()">
            Cancel
          </button>
          <button class="modal-btn primary" onclick="saveItem()">
            Add Expense
          </button>
        </div>
      </div>
    </div>

    <script>
      const totalIncome = 2900;
      let totalExpenses = 0;
      let currentCategory = '';
      let currentEditingId = null;
      let expenses = {
        essentials: [],
        basics: [],
        wants: [],
        virtual: []
      };

      function toggleModalAmountType(button, type) {
        // Remove active class from siblings
        button.parentElement
          .querySelectorAll('.amount-type-option')
          .forEach((btn) => {
            btn.classList.remove('active');
          });
        button.classList.add('active');

        // Update input fields in modal
        const container = document.getElementById('modal-amount-inputs');
        if (type === 'range') {
          container.innerHTML = `
            <input type="text" class="amount-input-modal" placeholder="£100" id="itemAmountMin">
            <span style="font-weight: 600; color: #64748b;">to</span>
            <input type="text" class="amount-input-modal" placeholder="£200" id="itemAmountMax">
          `;
        } else {
          container.innerHTML = `
            <input type="text" class="amount-input-modal" placeholder="£150" id="itemAmount">
          `;
        }
      }

      function addExpense(category) {
        currentCategory = category;
        currentEditingId = null;

        const modal = document.getElementById('addModal');
        const title = document.getElementById('modalTitle');
        const nameInput = document.getElementById('itemName');

        // Reset modal
        title.textContent = `Add ${category.charAt(0).toUpperCase() + category.slice(1)} Expense`;
        nameInput.value = '';

        // Reset amount type to exact
        const exactBtn = document.querySelector('.amount-type-option');
        toggleModalAmountType(exactBtn, 'exact');

        // Reset frequency
        document.getElementById('itemFrequency').value = 'monthly';

        modal.classList.add('show');
        nameInput.focus();
      }

      function editExpense(category, id) {
        const item = expenses[category].find((exp) => exp.id === id);
        if (!item) return;

        currentCategory = category;
        currentEditingId = id;

        const modal = document.getElementById('addModal');
        const title = document.getElementById('modalTitle');
        const nameInput = document.getElementById('itemName');

        title.textContent = `Edit ${item.name}`;
        nameInput.value = item.name;

        // Set amount type
        const isRange = item.amountType === 'range';
        const amountBtn = isRange
          ? document.querySelectorAll('.amount-type-option')[1]
          : document.querySelectorAll('.amount-type-option')[0];

        toggleModalAmountType(amountBtn, isRange ? 'range' : 'exact');

        // Set amount values
        setTimeout(() => {
          if (isRange) {
            document.getElementById('itemAmountMin').value =
              item.amountMin || '';
            document.getElementById('itemAmountMax').value =
              item.amountMax || '';
          } else {
            document.getElementById('itemAmount').value = item.amount || '';
          }
        }, 10);

        // Set frequency
        document.getElementById('itemFrequency').value =
          item.frequency || 'monthly';

        modal.classList.add('show');
        nameInput.focus();
      }

      function closeModal() {
        document.getElementById('addModal').classList.remove('show');
        currentEditingId = null;
      }

      function saveItem() {
        const nameInput = document.getElementById('itemName');
        const frequencySelect = document.getElementById('itemFrequency');
        const name = nameInput.value.trim();
        const frequency = frequencySelect.value;

        if (!name) {
          alert('Please enter an expense name');
          return;
        }

        // Determine if it's exact or range
        const isRange = document
          .querySelector('.amount-type-option.active')
          .textContent.includes('Range');

        let amount = 0;
        let amountDisplay = '';
        let item = {
          id: currentEditingId || Date.now(),
          name: name,
          frequency: frequency,
          amountType: isRange ? 'range' : 'exact'
        };

        if (isRange) {
          const minInput = document.getElementById('itemAmountMin');
          const maxInput = document.getElementById('itemAmountMax');
          const minAmount =
            parseFloat(minInput.value.replace(/[£,]/g, '')) || 0;
          const maxAmount =
            parseFloat(maxInput.value.replace(/[£,]/g, '')) || 0;

          if (minAmount <= 0 || maxAmount <= 0 || minAmount >= maxAmount) {
            alert('Please enter valid range amounts (min < max)');
            return;
          }

          item.amountMin = minAmount;
          item.amountMax = maxAmount;
          amount = (minAmount + maxAmount) / 2; // Use average for calculations
          amountDisplay = `£${minAmount.toLocaleString()}-£${maxAmount.toLocaleString()}`;
        } else {
          const amountInput = document.getElementById('itemAmount');
          const singleAmount =
            parseFloat(amountInput.value.replace(/[£,]/g, '')) || 0;

          if (singleAmount <= 0) {
            alert('Please enter a valid amount');
            return;
          }

          item.amount = singleAmount;
          amount = singleAmount;
          amountDisplay = `£${singleAmount.toLocaleString()}`;
        }

        // Convert to monthly if needed
        const monthlyAmount = convertToMonthly(amount, frequency);
        item.monthlyAmount = monthlyAmount;

        // Add frequency indicator to display if not monthly
        if (frequency !== 'monthly') {
          amountDisplay += `/${frequency}`;
        }
        item.amountDisplay = amountDisplay;

        // Add or update item
        if (currentEditingId) {
          // Update existing
          const index = expenses[currentCategory].findIndex(
            (exp) => exp.id === currentEditingId
          );
          if (index !== -1) {
            expenses[currentCategory][index] = item;
          }
        } else {
          // Add new
          expenses[currentCategory].push(item);
        }

        updateExpenseDisplay(currentCategory);
        updateExpenseTotals();
        closeModal();
      }

      function convertToMonthly(amount, frequency) {
        const multipliers = {
          monthly: 1,
          weekly: 4.33,
          fortnightly: 2.17,
          quarterly: 1 / 3,
          annually: 1 / 12
        };
        return amount * (multipliers[frequency] || 1);
      }

      function updateExpenseDisplay(category) {
        const list = document.getElementById(`${category}-list`);
        const placeholder = document.getElementById(`${category}-placeholder`);
        const items = expenses[category];

        if (items.length > 0) {
          placeholder.style.display = 'none';
          list.style.display = 'block';

          list.innerHTML = items
            .map(
              (item) => `
              <div class="expense-item">
                <div class="expense-name">${item.name}</div>
                <div class="expense-amount" onclick="editExpense('${category}', ${item.id})">
                  ${item.amountDisplay}
                </div>
                <div class="expense-actions">
                  <button class="expense-btn" onclick="editExpense('${category}', ${item.id})">Edit</button>
                  <button class="expense-btn delete" onclick="removeExpense('${category}', ${item.id})">Delete</button>
                </div>
              </div>
            `
            )
            .join('');
        } else {
          placeholder.style.display = 'block';
          list.style.display = 'none';
        }
      }

      function removeExpense(category, id) {
        expenses[category] = expenses[category].filter((exp) => exp.id !== id);
        updateExpenseDisplay(category);
        updateExpenseTotals();
      }

      function updateExpenseTotals() {
        // Calculate totals for each category
        let grandTotal = 0;

        Object.keys(expenses).forEach((category) => {
          const total = expenses[category].reduce(
            (sum, item) => sum + item.monthlyAmount,
            0
          );
          grandTotal += total;

          // Update category total display
          document.getElementById(`${category}-total`).textContent =
            `£${total.toLocaleString()}/month`;
        });

        totalExpenses = grandTotal;

        // Update sidebar - remove sidebar updates since we removed the sidebar section

        const remaining = totalIncome - totalExpenses;
        const recommendedGoalAmount = totalIncome * 0.2; // 20% for goals
        const allocationPercentage =
          totalIncome > 0 ? (totalExpenses / totalIncome) * 100 : 0;

        // Update main summary
        document.getElementById('allocated-display').textContent =
          totalExpenses.toLocaleString();

        // Update circular progress with lively stats
        updateCircularProgress(
          allocationPercentage,
          remaining,
          recommendedGoalAmount
        );

        // Update continue button
        const hasExpenses = Object.values(expenses).some(
          (category) => category.length > 0
        );
        const continueBtn = document.getElementById('step2-continue-btn');

        continueBtn.disabled = !hasExpenses || remaining < 0;
      }

      function updateCircularProgress(
        percentage,
        remaining,
        recommendedGoalAmount
      ) {
        const circularTrack = document.querySelector('.circular-track');
        const progressPercentage = document.getElementById(
          'progress-percentage'
        );
        const remainingAmount = document.getElementById('remaining-amount');
        const goalsAvailable = document.getElementById('goals-available');
        const progressStatus = document.getElementById('progress-status');
        const statusIcon = document.getElementById('status-icon');
        const statusText = document.getElementById('status-text');

        // Update the circular progress
        const fillAngle = Math.min(percentage, 100) * 3.6; // Convert percentage to degrees
        circularTrack.style.setProperty('--fill-angle', `${fillAngle}deg`);
        progressPercentage.textContent = `${Math.round(percentage)}%`;

        // Update stats
        remainingAmount.textContent = `£${Math.max(0, remaining).toLocaleString()}`;
        goalsAvailable.textContent = `£${Math.max(0, remaining).toLocaleString()}`;

        // Get stat items for styling
        const statItems = document.querySelectorAll('.stat-item');
        const remainingStatValue = document.getElementById('remaining-amount');
        const goalsStatValue = document.getElementById('goals-available');

        // Remove existing classes
        statItems.forEach((item) => {
          item.classList.remove('excellent', 'warning', 'danger');
        });
        remainingStatValue.classList.remove('celebrating', 'pulsing');
        goalsStatValue.classList.remove('celebrating', 'pulsing');

        // Remove existing state classes
        circularTrack.classList.remove(
          'excellent',
          'good',
          'warning',
          'danger'
        );
        progressStatus.classList.remove(
          'excellent',
          'good',
          'warning',
          'danger'
        );

        // Determine state and update styling
        let statusMessage = '';
        let statusEmoji = '';

        if (percentage === 0) {
          statusEmoji = '💡';
          statusMessage = 'Start adding expenses to see your progress';
        } else if (remaining >= recommendedGoalAmount) {
          // Excellent zone - 20% or more left for goals
          circularTrack.classList.add('excellent');
          progressStatus.classList.add('excellent');
          statItems.forEach((item) => item.classList.add('excellent'));

          statusEmoji = '🎯';
          statusMessage = `Perfect! £${remaining.toLocaleString()} available for your goals (${Math.round((remaining / totalIncome) * 100)}% of income)`;

          // Add celebration effects
          setTimeout(() => {
            goalsStatValue.classList.add('celebrating');
            remainingStatValue.classList.add('pulsing');
          }, 100);
        } else if (remaining > 0) {
          // Good zone - some money left but less than 20%
          circularTrack.classList.add('good');
          statItems.forEach((item) => item.classList.add('warning'));

          statusEmoji = '👍';
          statusMessage = `Good progress! £${remaining.toLocaleString()} remaining for goals`;

          setTimeout(() => remainingStatValue.classList.add('pulsing'), 100);
        } else if (remaining === 0) {
          // Warning - exactly balanced
          circularTrack.classList.add('warning');
          progressStatus.classList.add('warning');
          statItems.forEach((item) => item.classList.add('warning'));

          statusEmoji = '⚡';
          statusMessage =
            'Budget perfectly balanced, but consider leaving room for goals';
        } else {
          // Danger - over budget
          circularTrack.classList.add('danger');
          progressStatus.classList.add('danger');
          statItems.forEach((item) => item.classList.add('danger'));

          statusEmoji = '⚠️';
          statusMessage = `Over budget by £${Math.abs(remaining).toLocaleString()}. Try reducing some expenses.`;
        }

        statusIcon.textContent = statusEmoji;
        statusText.textContent = statusMessage;
      }

      function continueToGoals() {
        const remaining = totalIncome - totalExpenses;
        alert(
          `Great! Your expenses total £${totalExpenses.toLocaleString()}/month.\n\nYou have £${remaining.toLocaleString()}/month available for your goals.\n\nNext, we'll help you set meaningful goals for your surplus.`
        );
        // In a real app, this would navigate to the goals step
      }

      function backToIncome() {
        alert('Going back to income step...');
        // In a real app, this would navigate to the income step
      }

      // Close modal when clicking outside
      document
        .getElementById('addModal')
        .addEventListener('click', function (e) {
          if (e.target === this) {
            closeModal();
          }
        });

      // Handle Enter key in modal
      document.addEventListener('keydown', function (e) {
        if (
          e.key === 'Enter' &&
          document.getElementById('addModal').classList.contains('show')
        ) {
          saveItem();
        } else if (e.key === 'Escape') {
          closeModal();
        }
      });

      // Initialize
      updateExpenseTotals();

      // Set initial state
      updateCircularProgress(0, totalIncome, totalIncome * 0.2);
    </script>
  </body>
</html>
